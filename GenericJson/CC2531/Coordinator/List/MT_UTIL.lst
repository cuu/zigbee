###############################################################################
#                                                                             #
# IAR C/C++ Compiler V8.10.3.40338/W32 for 8051         25/Jan/2015  16:46:20 #
# Copyright 2004-2011 IAR Systems AB.                                         #
#                                                                             #
#    Core               =  plain                                              #
#    Code model         =  banked                                             #
#    Data model         =  large                                              #
#    Calling convention =  xdata reentrant                                    #
#    Constant location  =  data_rom                                           #
#    Dptr setup         =  1,16                                               #
#    Source file        =  C:\Texas Instruments\ZStack-CC2530-2.5.1a\Componen #
#                          ts\mt\MT_UTIL.c                                    #
#    Command line       =  -f "C:\Texas Instruments\ZStack-CC2530-2.5.1a\Proj #
#                          ects\zstack\Samples\GenericApp\CC2531\..\..\..\Too #
#                          ls\CC2530DB\f8wCoord.cfg" (-DCPU32MHZ              #
#                          -DROOT=__near_func -DMAC_CFG_APP_PENDING_QUEUE=TRU #
#                          E -DMAC_CFG_TX_DATA_MAX=5 -DMAC_CFG_TX_MAX=8       #
#                          -DMAC_CFG_RX_MAX=5 -DZDO_COORDINATOR -DRTR_NWK)    #
#                          -f "C:\Texas Instruments\ZStack-CC2530-2.5.1a\Proj #
#                          ects\zstack\Samples\GenericApp\CC2531\..\..\..\Too #
#                          ls\CC2530DB\f8wConfig.cfg" (-DZIGBEEPRO            #
#                          -DSECURE=0 -DZG_SECURE_DYNAMIC=0 -DREFLECTOR       #
#                          -DDEFAULT_CHANLIST=0x00000800                      #
#                          -DZDAPP_CONFIG_PAN_ID=0xFFFF                       #
#                          -DNWK_START_DELAY=100 -DEXTENDED_JOINING_RANDOM_MA #
#                          SK=0x007F -DBEACON_REQUEST_DELAY=100               #
#                          -DBEACON_REQ_DELAY_MASK=0x00FF                     #
#                          -DLINK_STATUS_JITTER_MASK=0x007F                   #
#                          -DROUTE_EXPIRY_TIME=30 -DAPSC_ACK_WAIT_DURATION_PO #
#                          LLED=3000 -DNWK_INDIRECT_MSG_TIMEOUT=7             #
#                          -DMAX_RREQ_ENTRIES=8 -DAPSC_MAX_FRAME_RETRIES=3    #
#                          -DNWK_MAX_DATA_RETRIES=2                           #
#                          -DMAX_POLL_FAILURE_RETRIES=2 -DMAX_BCAST=9         #
#                          -DAPS_MAX_GROUPS=16 -DMAX_RTG_ENTRIES=40           #
#                          -DNWK_MAX_BINDING_ENTRIES=4                        #
#                          -DMAX_BINDING_CLUSTER_IDS=4 "-DDEFAULT_KEY={0x01,  #
#                          0x03, 0x05, 0x07, 0x09, 0x0B, 0x0D, 0x0F, 0x00,    #
#                          0x02, 0x04, 0x06, 0x08, 0x0A, 0x0C, 0x0D}"         #
#                          -DMAC_MAX_FRAME_SIZE=116                           #
#                          -DZDNWKMGR_MIN_TRANSMISSIONS=20 "-DCONST=const     #
#                          __code" -DGENERIC=__generic                        #
#                          -DRFD_RCVC_ALWAYS_ON=FALSE -DPOLL_RATE=1000        #
#                          -DQUEUED_POLL_RATE=100 -DRESPONSE_POLL_RATE=100)   #
#                          -DREJOIN_POLL_RATE=440 "C:\Texas                   #
#                          Instruments\ZStack-CC2530-2.5.1a\Components\mt\MT_ #
#                          UTIL.c" -D ZTOOL_P1 -D MT_TASK -D MT_AF_FUNC -D    #
#                          MT_AF_CB_FUNC -D MT_APP_FUNC -D MT_DEBUG_FUNC -D   #
#                          MT_NWK_FUNC -D MT_NWK_CB_FUNC -D MT_SYS_FUNC -D    #
#                          MT_SYS_FUNC -D MT_ZDO_FUNC -D MT_UTIL_FUNC -D      #
#                          MT_ZDO_CB_FUNC -D MT_ZDO_MGMT -D                   #
#                          LCD_SUPPORTED=FALSE -D HAL_LCD=FALSE -D            #
#                          HAL_LED=FALSE -D GUU_HAL_LED=TRUE -D NV_INIT -D    #
#                          NV_RESTORE -D xPOWER_SAVING -lC "C:\Texas          #
#                          Instruments\ZStack-CC2530-2.5.1a\Projects\zstack\S #
#                          amples\GenericApp\CC2531\Coordinator\List\" -lA    #
#                          "C:\Texas Instruments\ZStack-CC2530-2.5.1a\Project #
#                          s\zstack\Samples\GenericApp\CC2531\Coordinator\Lis #
#                          t\" --diag_suppress Pe001,Pa010 -o "C:\Texas       #
#                          Instruments\ZStack-CC2530-2.5.1a\Projects\zstack\S #
#                          amples\GenericApp\CC2531\Coordinator\Obj\" -e      #
#                          --no_code_motion --debug --core=plain --dptr=16,1  #
#                          --data_model=large --code_model=banked             #
#                          --calling_convention=xdata_reentrant               #
#                          --place_constants=data_rom --nr_virtual_regs 16    #
#                          -I "C:\Texas Instruments\ZStack-CC2530-2.5.1a\Proj #
#                          ects\zstack\Samples\GenericApp\CC2531\" -I         #
#                          "C:\Texas Instruments\ZStack-CC2530-2.5.1a\Project #
#                          s\zstack\Samples\GenericApp\CC2531\..\Source\" -I  #
#                          "C:\Texas Instruments\ZStack-CC2530-2.5.1a\Project #
#                          s\zstack\Samples\GenericApp\CC2531\..\..\..\ZMain\ #
#                          TI2530DB\" -I "C:\Texas Instruments\ZStack-CC2530- #
#                          2.5.1a\Projects\zstack\Samples\GenericApp\CC2531\. #
#                          .\..\..\..\..\Components\hal\include\" -I          #
#                          "C:\Texas Instruments\ZStack-CC2530-2.5.1a\Project #
#                          s\zstack\Samples\GenericApp\CC2531\..\..\..\..\..\ #
#                          Components\hal\target\CC2530USB\" -I "C:\Texas     #
#                          Instruments\ZStack-CC2530-2.5.1a\Projects\zstack\S #
#                          amples\GenericApp\CC2531\..\..\..\..\..\Components #
#                          \hal\target\CC2530USB\usb\library\" -I "C:\Texas   #
#                          Instruments\ZStack-CC2530-2.5.1a\Projects\zstack\S #
#                          amples\GenericApp\CC2531\..\..\..\..\..\Components #
#                          \hal\target\CC2530USB\usb\library\cc2531\" -I      #
#                          "C:\Texas Instruments\ZStack-CC2530-2.5.1a\Project #
#                          s\zstack\Samples\GenericApp\CC2531\..\..\..\..\..\ #
#                          Components\hal\target\CC2530USB\usb\class_cdc\"    #
#                          -I "C:\Texas Instruments\ZStack-CC2530-2.5.1a\Proj #
#                          ects\zstack\Samples\GenericApp\CC2531\..\..\..\..\ #
#                          ..\Components\mac\include\" -I "C:\Texas           #
#                          Instruments\ZStack-CC2530-2.5.1a\Projects\zstack\S #
#                          amples\GenericApp\CC2531\..\..\..\..\..\Components #
#                          \mac\high_level\" -I "C:\Texas                     #
#                          Instruments\ZStack-CC2530-2.5.1a\Projects\zstack\S #
#                          amples\GenericApp\CC2531\..\..\..\..\..\Components #
#                          \mac\low_level\srf04\" -I "C:\Texas                #
#                          Instruments\ZStack-CC2530-2.5.1a\Projects\zstack\S #
#                          amples\GenericApp\CC2531\..\..\..\..\..\Components #
#                          \mac\low_level\srf04\single_chip\" -I "C:\Texas    #
#                          Instruments\ZStack-CC2530-2.5.1a\Projects\zstack\S #
#                          amples\GenericApp\CC2531\..\..\..\..\..\Components #
#                          \mt\" -I "C:\Texas Instruments\ZStack-CC2530-2.5.1 #
#                          a\Projects\zstack\Samples\GenericApp\CC2531\..\..\ #
#                          ..\..\..\Components\osal\include\" -I "C:\Texas    #
#                          Instruments\ZStack-CC2530-2.5.1a\Projects\zstack\S #
#                          amples\GenericApp\CC2531\..\..\..\..\..\Components #
#                          \services\saddr\" -I "C:\Texas                     #
#                          Instruments\ZStack-CC2530-2.5.1a\Projects\zstack\S #
#                          amples\GenericApp\CC2531\..\..\..\..\..\Components #
#                          \services\sdata\" -I "C:\Texas                     #
#                          Instruments\ZStack-CC2530-2.5.1a\Projects\zstack\S #
#                          amples\GenericApp\CC2531\..\..\..\..\..\Components #
#                          \stack\af\" -I "C:\Texas                           #
#                          Instruments\ZStack-CC2530-2.5.1a\Projects\zstack\S #
#                          amples\GenericApp\CC2531\..\..\..\..\..\Components #
#                          \stack\nwk\" -I "C:\Texas                          #
#                          Instruments\ZStack-CC2530-2.5.1a\Projects\zstack\S #
#                          amples\GenericApp\CC2531\..\..\..\..\..\Components #
#                          \stack\sapi\" -I "C:\Texas                         #
#                          Instruments\ZStack-CC2530-2.5.1a\Projects\zstack\S #
#                          amples\GenericApp\CC2531\..\..\..\..\..\Components #
#                          \stack\sec\" -I "C:\Texas                          #
#                          Instruments\ZStack-CC2530-2.5.1a\Projects\zstack\S #
#                          amples\GenericApp\CC2531\..\..\..\..\..\Components #
#                          \stack\sys\" -I "C:\Texas                          #
#                          Instruments\ZStack-CC2530-2.5.1a\Projects\zstack\S #
#                          amples\GenericApp\CC2531\..\..\..\..\..\Components #
#                          \stack\zdo\" -I "C:\Texas                          #
#                          Instruments\ZStack-CC2530-2.5.1a\Projects\zstack\S #
#                          amples\GenericApp\CC2531\..\..\..\..\..\Components #
#                          \zmac\" -I "C:\Texas Instruments\ZStack-CC2530-2.5 #
#                          .1a\Projects\zstack\Samples\GenericApp\CC2531\..\. #
#                          .\..\..\..\Components\zmac\f8w\" -I "C:\Texas      #
#                          Instruments\ZStack-CC2530-2.5.1a\Projects\zstack\S #
#                          amples\GenericApp\CC2531\..\..\weikong\Source\"    #
#                          -Ohz --require_prototypes                          #
#    List file          =  C:\Texas Instruments\ZStack-CC2530-2.5.1a\Projects #
#                          \zstack\Samples\GenericApp\CC2531\Coordinator\List #
#                          \MT_UTIL.lst                                       #
#    Object file        =  C:\Texas Instruments\ZStack-CC2530-2.5.1a\Projects #
#                          \zstack\Samples\GenericApp\CC2531\Coordinator\Obj\ #
#                          MT_UTIL.r51                                        #
#                                                                             #
#                                                                             #
###############################################################################

C:\Texas Instruments\ZStack-CC2530-2.5.1a\Components\mt\MT_UTIL.c
      1          /***************************************************************************************************
      2            Filename:       MT_UTIL.c
      3            Revised:        $Date: 2012-02-25 17:43:09 -0800 (Sat, 25 Feb 2012) $
      4            Revision:       $Revision: 29520 $
      5          
      6            Description:    MonitorTest Utility Functions
      7          
      8            Copyright 2007-2012 Texas Instruments Incorporated. All rights reserved.
      9          
     10            IMPORTANT: Your use of this Software is limited to those specific rights
     11            granted under the terms of a software license agreement between the user
     12            who downloaded the software, his/her employer (which must be your employer)
     13            and Texas Instruments Incorporated (the "License"). You may not use this
     14            Software unless you agree to abide by the terms of the License. The License
     15            limits your use, and you acknowledge, that the Software may not be modified,
     16            copied or distributed unless embedded on a Texas Instruments microcontroller
     17            or used solely and exclusively in conjunction with a Texas Instruments radio
     18            frequency transceiver, which is integrated into your product. Other than for
     19            the foregoing purpose, you may not use, reproduce, copy, prepare derivative
     20            works of, modify, distribute, perform, display or sell this Software and/or
     21            its documentation for any purpose.
     22          
     23            YOU FURTHER ACKNOWLEDGE AND AGREE THAT THE SOFTWARE AND DOCUMENTATION ARE
     24            PROVIDED “AS IS?WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESS OR IMPLIED,
     25            INCLUDING WITHOUT LIMITATION, ANY WARRANTY OF MERCHANTABILITY, TITLE,
     26            NON-INFRINGEMENT AND FITNESS FOR A PARTICULAR PURPOSE. IN NO EVENT SHALL
     27            TEXAS INSTRUMENTS OR ITS LICENSORS BE LIABLE OR OBLIGATED UNDER CONTRACT,
     28            NEGLIGENCE, STRICT LIABILITY, CONTRIBUTION, BREACH OF WARRANTY, OR OTHER
     29            LEGAL EQUITABLE THEORY ANY DIRECT OR INDIRECT DAMAGES OR EXPENSES
     30            INCLUDING BUT NOT LIMITED TO ANY INCIDENTAL, SPECIAL, INDIRECT, PUNITIVE
     31            OR CONSEQUENTIAL DAMAGES, LOST PROFITS OR LOST DATA, COST OF PROCUREMENT
     32            OF SUBSTITUTE GOODS, TECHNOLOGY, SERVICES, OR ANY CLAIMS BY THIRD PARTIES
     33            (INCLUDING BUT NOT LIMITED TO ANY DEFENSE THEREOF), OR OTHER SIMILAR COSTS.
     34          
     35            Should you have any questions regarding your right to use this Software,
     36            contact Texas Instruments Incorporated at www.TI.com.
     37          
     38           ***************************************************************************************************/
     39          
     40          /***************************************************************************************************
     41           * INCLUDES
     42           ***************************************************************************************************/
     43          #include "ZComDef.h"
     44          
     45          #include "AddrMgr.h"
     46          
     47          #include "OnBoard.h"   /* This is here because of the key reading */
     48          #include "hal_key.h"
     49          #include "hal_led.h"
     50          #include "OSAL_Nv.h"
     51          #include "osal.h"
     52          #include "NLMEDE.h"
     53          #include "MT.h"
     54          #include "MT_UTIL.h"
     55          #include "MT_MAC.h"
     56          #include "ssp.h"
     57          #if defined ZCL_KEY_ESTABLISH
     58          #include "zcl_key_establish.h"
     59          #endif
     60          #if defined TC_LINKKEY_JOIN
     61          #include "zcl_se.h"
     62          #endif
     63          
     64          #if !defined NONWK
     65          #include "MT_ZDO.h"
     66          #include "MT_SAPI.h"
     67          #include "MT_NWK.h"
     68          #include "MT_AF.h"
     69          #include "AssocList.h"
     70          #include "ZDApp.h"
     71          #include "ZDSecMgr.h"
     72          #endif
     73          /***************************************************************************************************
     74           * CONSTANTS
     75           ***************************************************************************************************/
     76          #define MT_UTIL_DEVICE_INFO_RESPONSE_LEN 14
     77          #define MT_UTIL_STATUS_LEN    1
     78          #define MT_UTIL_FRM_CTR_LEN   4
     79          // Status + LinkKeyDataLen + Tx+Rx Frame counter.
     80          #define MT_APSME_LINKKEY_GET_RSP_LEN (MT_UTIL_STATUS_LEN + SEC_KEY_LEN + (MT_UTIL_FRM_CTR_LEN * 2))
     81          // Status + NV id
     82          #define MT_APSME_LINKKEY_NV_ID_GET_RSP_LEN (MT_UTIL_STATUS_LEN + 2)
     83          
     84          /***************************************************************************************************
     85           * LOCAL VARIABLES
     86           ***************************************************************************************************/
     87          #if defined ZCL_KEY_ESTABLISH
     88          uint8 zcl_key_establish_task_id;
     89          #endif
     90          
     91          /***************************************************************************************************
     92           * LOCAL FUNCTIONS
     93           ***************************************************************************************************/
     94          #ifdef AUTO_PEND
     95          static void MT_UtilRevExtCpy( uint8 *pDst, uint8 *pSrc );
     96          static void MT_UtilSpi2Addr( zAddrType_t *pDst, uint8 *pSrc );
     97          #endif
     98          
     99          #if defined (MT_UTIL_FUNC)
    100          void MT_UtilGetDeviceInfo(void);
    101          void MT_UtilGetNvInfo(void);
    102          void MT_UtilSetPanID(uint8 *pBuf);
    103          void MT_UtilSetChannels(uint8 *pBuf);
    104          void MT_UtilSetSecLevel(uint8 *pBuf);
    105          void MT_UtilSetPreCfgKey(uint8 *pBuf);
    106          void MT_UtilCallbackSub(uint8 *pData);
    107          void MT_UtilKeyEvent(uint8 *pBuf);
    108          void MT_UtilTimeAlive(void);
    109          void MT_UtilLedControl(uint8 *pBuf);
    110          void MT_UtilSrcMatchEnable (uint8 *pBuf);
    111          void MT_UtilSrcMatchAddEntry (uint8 *pBuf);
    112          void MT_UtilSrcMatchDeleteEntry (uint8 *pBuf);
    113          void MT_UtilSrcMatchCheckSrcAddr (uint8 *pBuf);
    114          void MT_UtilSrcMatchAckAllPending (uint8 *pBuf);
    115          void MT_UtilSrcMatchCheckAllPending (uint8 *pBuf);
    116          
    117          #if !defined NONWK
    118          void MT_UtilDataReq(uint8 *pBuf);
    119          static void MT_UtilAddrMgrEntryLookupExt(uint8 *pBuf);
    120          static void MT_UtilAddrMgrEntryLookupNwk(uint8 *pBuf);
    121          #if defined MT_SYS_KEY_MANAGEMENT
    122          static void MT_UtilAPSME_LinkKeyDataGet(uint8 *pBuf);
    123          static void MT_UtilAPSME_LinkKeyNvIdGet(uint8 *pBuf);
    124          #endif //MT_SYS_KEY_MANAGEMENT
    125          static void MT_UtilAPSME_RequestKeyCmd(uint8 *pBuf);
    126          static void MT_UtilAssocCount(uint8 *pBuf);
    127          static void MT_UtilAssocFindDevice(uint8 *pBuf);
    128          static void MT_UtilAssocGetWithAddress(uint8 *pBuf);
    129          static void packDev_t(uint8 *pBuf, associated_devices_t *pDev);
    130          #if defined ZCL_KEY_ESTABLISH
    131          //static void MT_UtilzclGeneral_KeyEstablish_InitiateKeyEstablishment(uint8 *pBuf);
    132          static void MT_UtilzclGeneral_KeyEstablishment_ECDSASign(uint8 *pBuf);
    133          #endif // ZCL_KEY_ESTABLISH
    134          static void MT_UtilSync(void);
    135          #endif // !defined NONWK
    136          #endif // MT_UTIL_FUNC
    137          
    138          #if defined (MT_UTIL_FUNC)
    139          /***************************************************************************************************
    140           * @fn      MT_UtilProcessing
    141           *
    142           * @brief   Process all the DEBUG commands that are issued by test tool
    143           *
    144           * @param   pBuf  - pointer to received SPI data message
    145           *
    146           * @return  status
    147           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    148          uint8 MT_UtilCommandProcessing(uint8 *pBuf)
   \                     MT_UtilCommandProcessing:
    149          {
   \   000000   74F1         MOV     A,#-0xf
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 15
   \   000005                ; Auto size: 22
   \   000005   74EA         MOV     A,#-0x16
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
    150            uint8 status = MT_RPC_SUCCESS;
   \   00000A   75..00       MOV     ?V0 + 2,#0x0
    151          
    152            switch (pBuf[MT_RPC_POS_CMD1])
   \   00000D   8A82         MOV     DPL,R2
   \   00000F   8B83         MOV     DPH,R3
   \   000011   A3           INC     DPTR
   \   000012   A3           INC     DPTR
   \   000013   E0           MOVX    A,@DPTR
   \   000014   7003         JNZ     $+5
   \   000016   02....       LJMP    ??MT_UtilCommandProcessing_0 & 0xFFFF
   \   000019   14           DEC     A
   \   00001A   7003         JNZ     $+5
   \   00001C   02....       LJMP    ??MT_UtilCommandProcessing_1 & 0xFFFF
   \   00001F   14           DEC     A
   \   000020   7003         JNZ     $+5
   \   000022   02....       LJMP    ??MT_UtilCommandProcessing_2 & 0xFFFF
   \   000025   14           DEC     A
   \   000026   7003         JNZ     $+5
   \   000028   02....       LJMP    ??MT_UtilCommandProcessing_3 & 0xFFFF
   \   00002B   14           DEC     A
   \   00002C   7003         JNZ     $+5
   \   00002E   02....       LJMP    ??MT_UtilCommandProcessing_4 & 0xFFFF
   \   000031   14           DEC     A
   \   000032   7003         JNZ     $+5
   \   000034   02....       LJMP    ??MT_UtilCommandProcessing_5 & 0xFFFF
   \   000037   14           DEC     A
   \   000038   7003         JNZ     $+5
   \   00003A   02....       LJMP    ??MT_UtilCommandProcessing_6 & 0xFFFF
   \   00003D   14           DEC     A
   \   00003E   7003         JNZ     $+5
   \   000040   02....       LJMP    ??MT_UtilCommandProcessing_7 & 0xFFFF
   \   000043   24FE         ADD     A,#-0x2
   \   000045   7003         JNZ     $+5
   \   000047   02....       LJMP    ??MT_UtilCommandProcessing_8 & 0xFFFF
   \   00004A   14           DEC     A
   \   00004B   7003         JNZ     $+5
   \   00004D   02....       LJMP    ??MT_UtilCommandProcessing_9 & 0xFFFF
   \   000050   24FA         ADD     A,#-0x6
   \   000052   7003         JNZ     $+5
   \   000054   02....       LJMP    ??MT_UtilCommandProcessing_10 & 0xFFFF
   \   000057   14           DEC     A
   \   000058   7003         JNZ     $+5
   \   00005A   02....       LJMP    ??MT_UtilCommandProcessing_11 & 0xFFFF
   \   00005D   24F1         ADD     A,#-0xf
   \   00005F   7003         JNZ     $+5
   \   000061   02....       LJMP    ??MT_UtilCommandProcessing_12 & 0xFFFF
   \   000064   14           DEC     A
   \   000065   7003         JNZ     $+5
   \   000067   02....       LJMP    ??MT_UtilCommandProcessing_13 & 0xFFFF
   \   00006A   14           DEC     A
   \   00006B   7003         JNZ     $+5
   \   00006D   02....       LJMP    ??MT_UtilCommandProcessing_14 & 0xFFFF
   \   000070   14           DEC     A
   \   000071   7003         JNZ     $+5
   \   000073   02....       LJMP    ??MT_UtilCommandProcessing_15 & 0xFFFF
   \   000076   14           DEC     A
   \   000077   7003         JNZ     $+5
   \   000079   02....       LJMP    ??MT_UtilCommandProcessing_16 & 0xFFFF
   \   00007C   14           DEC     A
   \   00007D   7003         JNZ     $+5
   \   00007F   02....       LJMP    ??MT_UtilCommandProcessing_17 & 0xFFFF
   \   000082   24E5         ADD     A,#-0x1b
   \   000084   7003         JNZ     $+5
   \   000086   02....       LJMP    ??MT_UtilCommandProcessing_18 & 0xFFFF
   \   000089   14           DEC     A
   \   00008A   7003         JNZ     $+5
   \   00008C   02....       LJMP    ??MT_UtilCommandProcessing_19 & 0xFFFF
   \   00008F   24F9         ADD     A,#-0x7
   \   000091   7003         JNZ     $+5
   \   000093   02....       LJMP    ??MT_UtilCommandProcessing_20 & 0xFFFF
   \   000096   14           DEC     A
   \   000097   7003         JNZ     $+5
   \   000099   02....       LJMP    ??MT_UtilCommandProcessing_21 & 0xFFFF
   \   00009C   14           DEC     A
   \   00009D   7003         JNZ     $+5
   \   00009F   02....       LJMP    ??MT_UtilCommandProcessing_22 & 0xFFFF
   \   0000A2   14           DEC     A
   \   0000A3   7003         JNZ     $+5
   \   0000A5   02....       LJMP    ??MT_UtilCommandProcessing_23 & 0xFFFF
   \   0000A8   246B         ADD     A,#0x6b
   \   0000AA   7003         JNZ     $+5
   \   0000AC   02....       LJMP    ??MT_UtilCommandProcessing_24 & 0xFFFF
   \   0000AF   02....       LJMP    ??MT_UtilCommandProcessing_25 & 0xFFFF
    153            {
    154          // CC253X MAC Network Processor does not have NV support
    155          #if !defined(CC253X_MACNP)
    156              case MT_UTIL_GET_DEVICE_INFO:
    157                MT_UtilGetDeviceInfo();
   \                     ??MT_UtilCommandProcessing_0:
   \   0000B2                ; Setup parameters for call to function MT_UtilGetDeviceInfo
   \   0000B2   12....       LCALL   ??MT_UtilGetDeviceInfo?relay
    158                break;
   \   0000B5   02....       LJMP    ??MT_UtilCommandProcessing_26 & 0xFFFF
    159          
    160              case MT_UTIL_GET_NV_INFO:
    161                MT_UtilGetNvInfo();
   \                     ??MT_UtilCommandProcessing_1:
   \   0000B8                ; Setup parameters for call to function MT_UtilGetNvInfo
   \   0000B8   12....       LCALL   ??MT_UtilGetNvInfo?relay
    162                break;
   \   0000BB   02....       LJMP    ??MT_UtilCommandProcessing_26 & 0xFFFF
    163          
    164              case MT_UTIL_SET_PANID:
    165                MT_UtilSetPanID(pBuf);
   \                     ??MT_UtilCommandProcessing_2:
   \   0000BE                ; Setup parameters for call to function MT_UtilSetPanID
   \   0000BE   12....       LCALL   ??MT_UtilSetPanID?relay
    166                break;
   \   0000C1   02....       LJMP    ??MT_UtilCommandProcessing_26 & 0xFFFF
    167          
    168              case MT_UTIL_SET_CHANNELS:
    169                MT_UtilSetChannels(pBuf);
   \                     ??MT_UtilCommandProcessing_3:
   \   0000C4                ; Setup parameters for call to function MT_UtilSetChannels
   \   0000C4   12....       LCALL   ??MT_UtilSetChannels?relay
    170                break;
   \   0000C7   02....       LJMP    ??MT_UtilCommandProcessing_26 & 0xFFFF
    171          
    172              case MT_UTIL_SET_SECLEVEL:
    173                MT_UtilSetSecLevel(pBuf);
   \                     ??MT_UtilCommandProcessing_4:
   \   0000CA                ; Setup parameters for call to function MT_UtilSetSecLevel
   \   0000CA   12....       LCALL   ??MT_UtilSetSecLevel?relay
    174                break;
   \   0000CD   02....       LJMP    ??MT_UtilCommandProcessing_26 & 0xFFFF
    175          
    176              case MT_UTIL_SET_PRECFGKEY:
    177                MT_UtilSetPreCfgKey(pBuf);
   \                     ??MT_UtilCommandProcessing_5:
   \   0000D0                ; Setup parameters for call to function MT_UtilSetPreCfgKey
   \   0000D0   12....       LCALL   ??MT_UtilSetPreCfgKey?relay
    178                break;
   \   0000D3   02....       LJMP    ??MT_UtilCommandProcessing_26 & 0xFFFF
    179          #endif
    180              case MT_UTIL_CALLBACK_SUB_CMD:
    181                MT_UtilCallbackSub(pBuf);
   \                     ??MT_UtilCommandProcessing_6:
   \   0000D6                ; Setup parameters for call to function MT_UtilCallbackSub
   \   0000D6   12....       LCALL   ??MT_UtilCallbackSub?relay
    182                break;
   \   0000D9   02....       LJMP    ??MT_UtilCommandProcessing_26 & 0xFFFF
    183          
    184              case MT_UTIL_KEY_EVENT:
    185          #if (defined HAL_KEY) && (HAL_KEY == TRUE)
    186                MT_UtilKeyEvent(pBuf);
   \                     ??MT_UtilCommandProcessing_7:
   \   0000DC                ; Setup parameters for call to function MT_UtilKeyEvent
   \   0000DC   12....       LCALL   ??MT_UtilKeyEvent?relay
    187          #endif
    188                break;
   \   0000DF   02....       LJMP    ??MT_UtilCommandProcessing_26 & 0xFFFF
    189          
    190              case MT_UTIL_TIME_ALIVE:
    191                MT_UtilTimeAlive();
   \                     ??MT_UtilCommandProcessing_8:
   \   0000E2                ; Setup parameters for call to function MT_UtilTimeAlive
   \   0000E2   12....       LCALL   ??MT_UtilTimeAlive?relay
    192                break;
   \   0000E5   02....       LJMP    ??MT_UtilCommandProcessing_26 & 0xFFFF
    193          
    194              case MT_UTIL_LED_CONTROL:
    195          #if (defined GUU_HAL_LED) && (GUU_HAL_LED == TRUE)//czv7 GUU_HAL_LED µÄÐÞ¸Ä
    196                MT_UtilLedControl(pBuf);
   \                     ??MT_UtilCommandProcessing_9:
   \   0000E8                ; Setup parameters for call to function MT_UtilLedControl
   \   0000E8   12....       LCALL   ??MT_UtilLedControl?relay
    197          #endif
    198                break;
   \   0000EB   02....       LJMP    ??MT_UtilCommandProcessing_26 & 0xFFFF
    199          
    200              case MT_UTIL_SRC_MATCH_ENABLE:
    201                MT_UtilSrcMatchEnable(pBuf);
   \                     ??MT_UtilCommandProcessing_12:
   \   0000EE                ; Setup parameters for call to function MT_UtilSrcMatchEnable
   \   0000EE   12....       LCALL   ??MT_UtilSrcMatchEnable?relay
    202                break;
   \   0000F1   02....       LJMP    ??MT_UtilCommandProcessing_26 & 0xFFFF
    203          
    204              case MT_UTIL_SRC_MATCH_ADD_ENTRY:
    205                MT_UtilSrcMatchAddEntry(pBuf);
   \                     ??MT_UtilCommandProcessing_13:
   \   0000F4                ; Setup parameters for call to function MT_UtilSrcMatchAddEntry
   \   0000F4   12....       LCALL   ??MT_UtilSrcMatchAddEntry?relay
    206                break;
   \   0000F7   02....       LJMP    ??MT_UtilCommandProcessing_26 & 0xFFFF
    207          
    208              case MT_UTIL_SRC_MATCH_DEL_ENTRY:
    209                MT_UtilSrcMatchDeleteEntry(pBuf);
   \                     ??MT_UtilCommandProcessing_14:
   \   0000FA                ; Setup parameters for call to function MT_UtilSrcMatchDeleteEntry
   \   0000FA   12....       LCALL   ??MT_UtilSrcMatchDeleteEntry?relay
    210                break;
   \   0000FD   02....       LJMP    ??MT_UtilCommandProcessing_26 & 0xFFFF
    211          
    212              case MT_UTIL_SRC_MATCH_CHECK_SRC_ADDR:
    213                MT_UtilSrcMatchCheckSrcAddr(pBuf);
   \                     ??MT_UtilCommandProcessing_15:
   \   000100                ; Setup parameters for call to function MT_UtilSrcMatchCheckSrcAddr
   \   000100   12....       LCALL   ??MT_UtilSrcMatchCheckSrcAddr?relay
    214                break;
   \   000103   02....       LJMP    ??MT_UtilCommandProcessing_26 & 0xFFFF
    215          
    216              case MT_UTIL_SRC_MATCH_ACK_ALL_PENDING:
    217                MT_UtilSrcMatchAckAllPending(pBuf);
   \                     ??MT_UtilCommandProcessing_16:
   \   000106                ; Setup parameters for call to function MT_UtilSrcMatchAckAllPending
   \   000106   12....       LCALL   ??MT_UtilSrcMatchAckAllPending?relay
    218                break;
   \   000109   02....       LJMP    ??MT_UtilCommandProcessing_26 & 0xFFFF
    219          
    220              case MT_UTIL_SRC_MATCH_CHECK_ALL_PENDING:
    221                MT_UtilSrcMatchCheckAllPending(pBuf);
   \                     ??MT_UtilCommandProcessing_17:
   \   00010C                ; Setup parameters for call to function MT_UtilSrcMatchCheckAllPending
   \   00010C   12....       LCALL   ??MT_UtilSrcMatchCheckAllPending?relay
    222                break;
   \   00010F   02....       LJMP    ??MT_UtilCommandProcessing_26 & 0xFFFF
    223          
    224              case MT_UTIL_TEST_LOOPBACK:
    225                MT_BuildAndSendZToolResponse((MT_RPC_CMD_SRSP|(uint8)MT_RPC_SYS_UTIL), MT_UTIL_TEST_LOOPBACK,
    226                                              pBuf[MT_RPC_POS_LEN], (pBuf+MT_RPC_FRAME_HDR_SZ));
   \                     ??MT_UtilCommandProcessing_10:
   \   000112                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   000112   EA           MOV     A,R2
   \   000113   2403         ADD     A,#0x3
   \   000115   FC           MOV     R4,A
   \   000116   EB           MOV     A,R3
   \   000117   3400         ADDC    A,#0x0
   \   000119   FD           MOV     R5,A
   \   00011A   8A82         MOV     DPL,R2
   \   00011C   8B83         MOV     DPH,R3
   \   00011E   E0           MOVX    A,@DPTR
   \   00011F   FB           MOV     R3,A
   \   000120   7A10         MOV     R2,#0x10
   \                     ??MT_UtilCommandProcessing_27:
   \   000122   7967         MOV     R1,#0x67
   \                     ??MT_UtilCommandProcessing_28:
   \   000124   12....       LCALL   ??MT_BuildAndSendZToolResponse?relay
    227                break;
   \   000127   02....       LJMP    ??MT_UtilCommandProcessing_26 & 0xFFFF
    228          
    229          #if !defined NONWK
    230              case MT_UTIL_DATA_REQ:
    231                MT_UtilDataReq(pBuf);
   \                     ??MT_UtilCommandProcessing_11:
   \   00012A                ; Setup parameters for call to function MT_UtilDataReq
   \   00012A   12....       LCALL   ??MT_UtilDataReq?relay
    232                break;
   \   00012D   02....       LJMP    ??MT_UtilCommandProcessing_26 & 0xFFFF
    233          
    234              case MT_UTIL_ADDRMGR_EXT_ADDR_LOOKUP:
    235                MT_UtilAddrMgrEntryLookupExt(pBuf);
   \                     ??MT_UtilCommandProcessing_18:
   \   000130                ; Setup parameters for call to function MT_UtilAddrMgrEntryLookupExt
   \   000130   12....       LCALL   ??MT_UtilAddrMgrEntryLookupExt?relay
    236                break;
   \   000133   02....       LJMP    ??MT_UtilCommandProcessing_26 & 0xFFFF
    237          
    238              case MT_UTIL_ADDRMGR_NWK_ADDR_LOOKUP:
    239                MT_UtilAddrMgrEntryLookupNwk(pBuf);
   \                     ??MT_UtilCommandProcessing_19:
   \   000136   8A82         MOV     DPL,R2
   \   000138   8B83         MOV     DPH,R3
   \   00013A   A3           INC     DPTR
   \   00013B   A3           INC     DPTR
   \   00013C   E0           MOVX    A,@DPTR
   \   00013D   FE           MOV     R6,A
   \   00013E   EA           MOV     A,R2
   \   00013F   2403         ADD     A,#0x3
   \   000141   F582         MOV     DPL,A
   \   000143   EB           MOV     A,R3
   \   000144   3400         ADDC    A,#0x0
   \   000146   F583         MOV     DPH,A
   \   000148   E0           MOVX    A,@DPTR
   \   000149   FA           MOV     R2,A
   \   00014A   A3           INC     DPTR
   \   00014B   E0           MOVX    A,@DPTR
   \   00014C   F9           MOV     R1,A
   \   00014D   EA           MOV     A,R2
   \   00014E   F8           MOV     R0,A
   \   00014F   740A         MOV     A,#0xa
   \   000151   12....       LCALL   ?XSTACK_DISP0_8
   \   000154   E8           MOV     A,R0
   \   000155   F0           MOVX    @DPTR,A
   \   000156   A3           INC     DPTR
   \   000157   E9           MOV     A,R1
   \   000158   F0           MOVX    @DPTR,A
   \   000159                ; Setup parameters for call to function AddrMgrEntryLookupNwk
   \   000159   7409         MOV     A,#0x9
   \   00015B   12....       LCALL   ?XSTACK_DISP0_8
   \   00015E   AA82         MOV     R2,DPL
   \   000160   AB83         MOV     R3,DPH
   \   000162   12....       LCALL   ??AddrMgrEntryLookupNwk?relay
   \   000165                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   000165   740C         MOV     A,#0xc
   \   000167   12....       LCALL   ?XSTACK_DISP0_8
   \   00016A   AC82         MOV     R4,DPL
   \   00016C   AD83         MOV     R5,DPH
   \   00016E   7B08         MOV     R3,#0x8
   \                     ??MT_UtilCommandProcessing_29:
   \   000170   EE           MOV     A,R6
   \   000171   FA           MOV     R2,A
   \   000172   80AE         SJMP    ??MT_UtilCommandProcessing_27
    240                break;
    241          
    242          #if defined MT_SYS_KEY_MANAGEMENT
    243              case MT_UTIL_APSME_LINK_KEY_DATA_GET:
    244                MT_UtilAPSME_LinkKeyDataGet(pBuf);
    245                break;
    246          
    247              case MT_UTIL_APSME_LINK_KEY_NV_ID_GET:
    248                MT_UtilAPSME_LinkKeyNvIdGet(pBuf);
    249                break;
    250          #endif // MT_SYS_KEY_MANAGEMENT
    251          
    252              case MT_UTIL_APSME_REQUEST_KEY_CMD:
    253                MT_UtilAPSME_RequestKeyCmd(pBuf);
   \                     ??MT_UtilCommandProcessing_23:
   \   000174   12....       LCALL   ?Subroutine14 & 0xFFFF
   \                     ??CrossCallReturnLabel_17:
   \   000177   89..         MOV     ?V0 + 4,R1
   \   000179   8A..         MOV     ?V0 + 5,R2
   \   00017B   75..00       MOV     ?V0 + 6,#0x0
   \   00017E   78..         MOV     R0,#?V0 + 4
   \   000180   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   000183   7C08         MOV     R4,#0x8
   \   000185   7D00         MOV     R5,#0x0
   \   000187   7404         MOV     A,#0x4
   \   000189   12....       LCALL   ?XSTACK_DISP0_8
   \   00018C   AA82         MOV     R2,DPL
   \   00018E   AB83         MOV     R3,DPH
   \   000190   12....       LCALL   ??osal_memcpy?relay
   \   000193   7403         MOV     A,#0x3
   \   000195   12....       LCALL   ?DEALLOC_XSTACK8
   \   000198                ; Setup parameters for call to function ZDSecMgrRequestAppKey
   \   000198   7401         MOV     A,#0x1
   \   00019A   12....       LCALL   ?XSTACK_DISP0_8
   \   00019D   AA82         MOV     R2,DPL
   \   00019F   AB83         MOV     R3,DPH
   \   0001A1   12....       LCALL   ??ZDSecMgrRequestAppKey?relay
   \   0001A4   12....       LCALL   ?Subroutine20 & 0xFFFF
   \                     ??CrossCallReturnLabel_58:
   \   0001A7   80C7         SJMP    ??MT_UtilCommandProcessing_29
    254                break;
    255          
    256              case MT_UTIL_ASSOC_COUNT:
    257                MT_UtilAssocCount(pBuf);
   \                     ??MT_UtilCommandProcessing_20:
   \   0001A9   8A82         MOV     DPL,R2
   \   0001AB   8B83         MOV     DPH,R3
   \   0001AD   A3           INC     DPTR
   \   0001AE   A3           INC     DPTR
   \   0001AF   E0           MOVX    A,@DPTR
   \   0001B0   F5..         MOV     ?V0 + 3,A
   \   0001B2   EA           MOV     A,R2
   \   0001B3   2403         ADD     A,#0x3
   \   0001B5   F8           MOV     R0,A
   \   0001B6   EB           MOV     A,R3
   \   0001B7   12....       LCALL   ?Subroutine17 & 0xFFFF
   \                     ??CrossCallReturnLabel_23:
   \   0001BA   A3           INC     DPTR
   \   0001BB   8582..       MOV     ?V0 + 0,DPL
   \   0001BE   8583..       MOV     ?V0 + 1,DPH
   \   0001C1                ; Setup parameters for call to function AssocCount
   \   0001C1   E0           MOVX    A,@DPTR
   \   0001C2   FA           MOV     R2,A
   \   0001C3   8E82         MOV     DPL,R6
   \   0001C5   8F83         MOV     DPH,R7
   \   0001C7   E0           MOVX    A,@DPTR
   \   0001C8   F9           MOV     R1,A
   \   0001C9   12....       LCALL   ??AssocCount?relay
   \   0001CC   EA           MOV     A,R2
   \   0001CD   8E82         MOV     DPL,R6
   \   0001CF   8F83         MOV     DPH,R7
   \   0001D1   F0           MOVX    @DPTR,A
   \   0001D2   85..82       MOV     DPL,?V0 + 0
   \   0001D5   85..83       MOV     DPH,?V0 + 1
   \   0001D8   EB           MOV     A,R3
   \   0001D9   F0           MOVX    @DPTR,A
   \   0001DA                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   0001DA   EE           MOV     A,R6
   \   0001DB   FC           MOV     R4,A
   \   0001DC   EF           MOV     A,R7
   \   0001DD   FD           MOV     R5,A
   \   0001DE   7B02         MOV     R3,#0x2
   \   0001E0   AA..         MOV     R2,?V0 + 3
   \   0001E2   02....       LJMP    ??MT_UtilCommandProcessing_27 & 0xFFFF
    258                break;
    259          
    260              case MT_UTIL_ASSOC_FIND_DEVICE:
    261                MT_UtilAssocFindDevice(pBuf);
   \                     ??MT_UtilCommandProcessing_21:
   \   0001E5                ; Setup parameters for call to function MT_UtilAssocFindDevice
   \   0001E5   12....       LCALL   ??MT_UtilAssocFindDevice?relay
    262                break;
   \   0001E8   8015         SJMP    ??MT_UtilCommandProcessing_26
    263          
    264              case MT_UTIL_ASSOC_GET_WITH_ADDRESS:
    265                MT_UtilAssocGetWithAddress(pBuf);
   \                     ??MT_UtilCommandProcessing_22:
   \   0001EA                ; Setup parameters for call to function MT_UtilAssocGetWithAddress
   \   0001EA   12....       LCALL   ??MT_UtilAssocGetWithAddress?relay
    266                break;
   \   0001ED   8010         SJMP    ??MT_UtilCommandProcessing_26
    267          
    268          #if defined ZCL_KEY_ESTABLISH
    269              case MT_UTIL_ZCL_KEY_EST_INIT_EST:
    270                //MT_UtilzclGeneral_KeyEstablish_InitiateKeyEstablishment(pBuf);
    271                break;
    272          
    273              case MT_UTIL_ZCL_KEY_EST_SIGN:
    274                MT_UtilzclGeneral_KeyEstablishment_ECDSASign(pBuf);
    275                break;
    276          #endif
    277          
    278              case MT_UTIL_SYNC_REQ:
    279                MT_UtilSync();
   \                     ??MT_UtilCommandProcessing_24:
   \   0001EF                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   0001EF   7C00         MOV     R4,#0x0
   \   0001F1   7D00         MOV     R5,#0x0
   \   0001F3   7B00         MOV     R3,#0x0
   \   0001F5   7AE0         MOV     R2,#-0x20
   \   0001F7   7947         MOV     R1,#0x47
   \   0001F9   02....       LJMP    ??MT_UtilCommandProcessing_28 & 0xFFFF
    280                break;
    281          #endif /* !defined NONWK */
    282          
    283              default:
    284                status = MT_RPC_ERR_COMMAND_ID;
   \                     ??MT_UtilCommandProcessing_25:
   \   0001FC   75..02       MOV     ?V0 + 2,#0x2
    285                break;
    286            }
    287          
    288            return status;
   \                     ??MT_UtilCommandProcessing_26:
   \   0001FF   A9..         MOV     R1,?V0 + 2
   \   000201   7416         MOV     A,#0x16
   \   000203   12....       LCALL   ?DEALLOC_XSTACK8
   \   000206   7F07         MOV     R7,#0x7
   \   000208   02....       LJMP    ?BANKED_LEAVE_XDATA
    289          }
    290          
    291          /***************************************************************************************************
    292           * @fn      MT_UtilGetDeviceInfo
    293           *
    294           * @brief   The Get Device Info serial message.
    295           *
    296           * @param   None.
    297           *
    298           * @return  void
    299           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    300          void MT_UtilGetDeviceInfo(void)
   \                     MT_UtilGetDeviceInfo:
    301          {
   \   000000   74F0         MOV     A,#-0x10
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 16
   \   000005                ; Auto size: 1
   \   000005   74FF         MOV     A,#-0x1
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
    302            uint8  *buf;
    303            uint8  *pBuf;
    304            uint8  bufLen = MT_UTIL_DEVICE_INFO_RESPONSE_LEN;
   \   00000A   75..0E       MOV     ?V0 + 2,#0xe
    305            uint16 *assocList = NULL;
   \   00000D   7E00         MOV     R6,#0x0
   \   00000F   7F00         MOV     R7,#0x0
    306          
    307          #if !defined NONWK
    308            uint8  assocCnt = 0;
   \   000011   85..82       MOV     DPL,?XSP + 0
   \   000014   85..83       MOV     DPH,?XSP + 1
   \   000017   E4           CLR     A
   \   000018   F0           MOVX    @DPTR,A
    309          
    310            if (ZG_DEVICE_RTR_TYPE)
   \   000019   90....       MOV     DPTR,#zgDeviceLogicalType
   \   00001C   E0           MOVX    A,@DPTR
   \   00001D   6004         JZ      ??MT_UtilGetDeviceInfo_0
   \   00001F   6401         XRL     A,#0x1
   \   000021   7022         JNZ     ??MT_UtilGetDeviceInfo_1
    311            {
    312              assocList = AssocMakeList( &assocCnt );
   \                     ??MT_UtilGetDeviceInfo_0:
   \   000023                ; Setup parameters for call to function AssocMakeList
   \   000023   85..82       MOV     DPL,?XSP + 0
   \   000026   85..83       MOV     DPH,?XSP + 1
   \   000029   AA82         MOV     R2,DPL
   \   00002B   AB83         MOV     R3,DPH
   \   00002D   12....       LCALL   ??AssocMakeList?relay
   \   000030   8A..         MOV     ?V0 + 0,R2
   \   000032   8B..         MOV     ?V0 + 1,R3
   \   000034   AE..         MOV     R6,?V0 + 0
   \   000036   AF..         MOV     R7,?V0 + 1
    313              bufLen += (assocCnt * sizeof(uint16));
   \   000038   85..82       MOV     DPL,?XSP + 0
   \   00003B   85..83       MOV     DPH,?XSP + 1
   \   00003E   E0           MOVX    A,@DPTR
   \   00003F   C3           CLR     C
   \   000040   33           RLC     A
   \   000041   240E         ADD     A,#0xe
   \   000043   F5..         MOV     ?V0 + 2,A
    314            }
    315          #endif
    316          
    317            buf = osal_mem_alloc( bufLen );
   \                     ??MT_UtilGetDeviceInfo_1:
   \   000045                ; Setup parameters for call to function osal_mem_alloc
   \   000045   85....       MOV     ?V0 + 0,?V0 + 2
   \   000048   AA..         MOV     R2,?V0 + 0
   \   00004A   7B00         MOV     R3,#0x0
   \   00004C   12....       LCALL   ??osal_mem_alloc?relay
   \   00004F   8A..         MOV     ?V0 + 0,R2
   \   000051   8B..         MOV     ?V0 + 1,R3
    318            if ( buf )
   \   000053   EA           MOV     A,R2
   \   000054   45..         ORL     A,?V0 + 1
   \   000056   7003         JNZ     $+5
   \   000058   02....       LJMP    ??MT_UtilGetDeviceInfo_2 & 0xFFFF
    319            {
    320              pBuf = buf;
    321          
    322              *pBuf++ = ZSUCCESS; // Status
   \   00005B   8A82         MOV     DPL,R2
   \   00005D   8B83         MOV     DPH,R3
   \   00005F   E4           CLR     A
   \   000060   12....       LCALL   ?Subroutine23 & 0xFFFF
    323          
    324              osal_nv_read( ZCD_NV_EXTADDR, 0, Z_EXTADDR_LEN, pBuf );
   \                     ??CrossCallReturnLabel_29:
   \   000063                ; Setup parameters for call to function osal_nv_read
   \   000063   78..         MOV     R0,#?V0 + 4
   \   000065   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000068   75..08       MOV     ?V0 + 6,#0x8
   \   00006B   75..00       MOV     ?V0 + 7,#0x0
   \   00006E   78..         MOV     R0,#?V0 + 6
   \   000070   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000073   12....       LCALL   ?Subroutine22 & 0xFFFF
   \                     ??CrossCallReturnLabel_52:
   \   000076   12....       LCALL   ?DEALLOC_XSTACK8
    325              pBuf += Z_EXTADDR_LEN;
   \   000079   E5..         MOV     A,?V0 + 4
   \   00007B   2408         ADD     A,#0x8
   \   00007D   F5..         MOV     ?V0 + 4,A
   \   00007F   E5..         MOV     A,?V0 + 5
   \   000081   3400         ADDC    A,#0x0
   \   000083   F5..         MOV     ?V0 + 5,A
    326          
    327          #if defined NONWK
    328              // Skip past ZStack only parameters for NONWK
    329              *pBuf++ = 0;
    330              *pBuf++ = 0;
    331              *pBuf++ = 0;
    332              *pBuf++ = 0;
    333              *pBuf = 0;
    334          #else
    335              {
    336                uint16 shortAddr = NLME_GetShortAddr();
   \   000085                ; Setup parameters for call to function NLME_GetShortAddr
   \   000085   12....       LCALL   ??NLME_GetShortAddr?relay
    337                *pBuf++ = LO_UINT16( shortAddr );
   \   000088   EA           MOV     A,R2
   \   000089   85..82       MOV     DPL,?V0 + 4
   \   00008C   85..83       MOV     DPH,?V0 + 5
   \   00008F   F0           MOVX    @DPTR,A
   \   000090   A3           INC     DPTR
    338                *pBuf++ = HI_UINT16( shortAddr );
   \   000091   EB           MOV     A,R3
   \   000092   F0           MOVX    @DPTR,A
   \   000093   A3           INC     DPTR
    339              }
    340          
    341              /* Return device type */
    342              *pBuf++ = ZSTACK_DEVICE_BUILD;
   \   000094   7401         MOV     A,#0x1
   \   000096   12....       LCALL   ?Subroutine23 & 0xFFFF
    343          
    344              /*Return device state */
    345              *pBuf++ = (uint8)devState;
   \                     ??CrossCallReturnLabel_30:
   \   000099   90....       MOV     DPTR,#devState
   \   00009C   12....       LCALL   ?Subroutine6 & 0xFFFF
    346          
    347              if (ZG_DEVICE_RTR_TYPE)
   \                     ??CrossCallReturnLabel_0:
   \   00009F   90....       MOV     DPTR,#zgDeviceLogicalType
   \   0000A2   E0           MOVX    A,@DPTR
   \   0000A3   6004         JZ      ??MT_UtilGetDeviceInfo_3
   \   0000A5   6401         XRL     A,#0x1
   \   0000A7   7040         JNZ     ??MT_UtilGetDeviceInfo_4
    348              {
    349                *pBuf++ = assocCnt;
   \                     ??MT_UtilGetDeviceInfo_3:
   \   0000A9   85..82       MOV     DPL,?XSP + 0
   \   0000AC   85..83       MOV     DPH,?XSP + 1
   \   0000AF   12....       LCALL   ?Subroutine6 & 0xFFFF
    350          
    351                if ( assocCnt )
   \                     ??CrossCallReturnLabel_1:
   \   0000B2   85..82       MOV     DPL,?XSP + 0
   \   0000B5   85..83       MOV     DPH,?XSP + 1
   \   0000B8   E0           MOVX    A,@DPTR
   \   0000B9   6036         JZ      ??MT_UtilGetDeviceInfo_5
    352                {
    353                  uint8 x;
    354                  uint16 *puint16 = assocList;
   \   0000BB   EE           MOV     A,R6
   \   0000BC   F8           MOV     R0,A
   \   0000BD   EF           MOV     A,R7
   \   0000BE   F9           MOV     R1,A
    355          
    356                  for ( x = 0; x < assocCnt; x++, puint16++ )
   \   0000BF   7C00         MOV     R4,#0x0
   \                     ??MT_UtilGetDeviceInfo_6:
   \   0000C1   85..82       MOV     DPL,?XSP + 0
   \   0000C4   85..83       MOV     DPH,?XSP + 1
   \   0000C7   E0           MOVX    A,@DPTR
   \   0000C8   FA           MOV     R2,A
   \   0000C9   EC           MOV     A,R4
   \   0000CA   C3           CLR     C
   \   0000CB   9A           SUBB    A,R2
   \   0000CC   5023         JNC     ??MT_UtilGetDeviceInfo_5
    357                  {
    358                    *pBuf++ = LO_UINT16( *puint16 );
   \   0000CE   8882         MOV     DPL,R0
   \   0000D0   8983         MOV     DPH,R1
   \   0000D2   12....       LCALL   ?Subroutine6 & 0xFFFF
    359                    *pBuf++ = HI_UINT16( *puint16 );
   \                     ??CrossCallReturnLabel_2:
   \   0000D5   8882         MOV     DPL,R0
   \   0000D7   8983         MOV     DPH,R1
   \   0000D9   A3           INC     DPTR
   \   0000DA   12....       LCALL   ?Subroutine6 & 0xFFFF
    360                  }
   \                     ??CrossCallReturnLabel_3:
   \   0000DD   0C           INC     R4
   \   0000DE   E8           MOV     A,R0
   \   0000DF   2402         ADD     A,#0x2
   \   0000E1   08           INC     R0
   \   0000E2   08           INC     R0
   \   0000E3   E9           MOV     A,R1
   \   0000E4   3400         ADDC    A,#0x0
   \   0000E6   F9           MOV     R1,A
   \   0000E7   80D8         SJMP    ??MT_UtilGetDeviceInfo_6
    361                }
    362              }
    363              else
    364              {
    365                *pBuf++ = 0;
   \                     ??MT_UtilGetDeviceInfo_4:
   \   0000E9   85..82       MOV     DPL,?V0 + 4
   \   0000EC   85..83       MOV     DPH,?V0 + 5
   \   0000EF   E4           CLR     A
   \   0000F0   F0           MOVX    @DPTR,A
    366              }
    367          #endif
    368          
    369              MT_BuildAndSendZToolResponse( ((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_UTIL),
    370                                           MT_UTIL_GET_DEVICE_INFO,
    371                                           bufLen, buf );
   \                     ??MT_UtilGetDeviceInfo_5:
   \   0000F1                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   0000F1   AC..         MOV     R4,?V0 + 0
   \   0000F3   AD..         MOV     R5,?V0 + 1
   \   0000F5   AB..         MOV     R3,?V0 + 2
   \   0000F7   7A00         MOV     R2,#0x0
   \   0000F9   7967         MOV     R1,#0x67
   \   0000FB   12....       LCALL   ??MT_BuildAndSendZToolResponse?relay
    372          
    373              osal_mem_free( buf );
   \   0000FE                ; Setup parameters for call to function osal_mem_free
   \   0000FE   AA..         MOV     R2,?V0 + 0
   \   000100   AB..         MOV     R3,?V0 + 1
   \   000102   12....       LCALL   ??osal_mem_free?relay
    374            }
    375          
    376            if ( assocList )
   \                     ??MT_UtilGetDeviceInfo_2:
   \   000105   EE           MOV     A,R6
   \   000106   4F           ORL     A,R7
   \   000107   6007         JZ      ??MT_UtilGetDeviceInfo_7
    377            {
    378              osal_mem_free( assocList );
   \   000109                ; Setup parameters for call to function osal_mem_free
   \   000109   EE           MOV     A,R6
   \   00010A   FA           MOV     R2,A
   \   00010B   EF           MOV     A,R7
   \   00010C   FB           MOV     R3,A
   \   00010D   12....       LCALL   ??osal_mem_free?relay
    379            }
    380          }
   \                     ??MT_UtilGetDeviceInfo_7:
   \   000110   7401         MOV     A,#0x1
   \   000112                REQUIRE ?Subroutine0
   \   000112                ; // Fall through to label ?Subroutine0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine0:
   \   000000   12....       LCALL   ?DEALLOC_XSTACK8
   \   000003   7F08         MOV     R7,#0x8
   \   000005   02....       LJMP    ?BANKED_LEAVE_XDATA

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine23:
   \   000000   12....       LCALL   ?Subroutine34 & 0xFFFF
   \                     ??CrossCallReturnLabel_51:
   \   000003   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine22:
   \   000000   7C00         MOV     R4,#0x0
   \   000002   7D00         MOV     R5,#0x0
   \   000004   7A01         MOV     R2,#0x1
   \   000006                REQUIRE ??Subroutine37_0
   \   000006                ; // Fall through to label ??Subroutine37_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine37_0:
   \   000000   7B00         MOV     R3,#0x0
   \   000002   12....       LCALL   ??osal_nv_read?relay
   \   000005   7404         MOV     A,#0x4
   \   000007   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine6:
   \   000000   E0           MOVX    A,@DPTR
   \   000001   85..82       MOV     DPL,?V0 + 4
   \   000004   85..83       MOV     DPH,?V0 + 5
   \   000007   12....       LCALL   ?Subroutine34 & 0xFFFF
   \                     ??CrossCallReturnLabel_50:
   \   00000A   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine34:
   \   000000   F0           MOVX    @DPTR,A
   \   000001   A3           INC     DPTR
   \   000002   8582..       MOV     ?V0 + 4,DPL
   \   000005   8583..       MOV     ?V0 + 5,DPH
   \   000008   22           RET
    381          
    382          /***************************************************************************************************
    383           * @fn      MT_UtilGetNvInfo
    384           *
    385           * @brief   The Get NV Info serial message.
    386           *
    387           * @param   None.
    388           *
    389           * @return  void
    390           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    391          void MT_UtilGetNvInfo(void)
   \                     MT_UtilGetNvInfo:
    392          {
   \   000000   74F0         MOV     A,#-0x10
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 16
   \   000005                ; Auto size: 6
   \   000005   74FA         MOV     A,#-0x6
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
    393            uint8 len;
    394            uint8 stat;
    395            uint8 *buf;
    396            uint8 *pBuf;
    397            uint16 tmp16;
    398            uint32 tmp32;
    399          
    400            /*
    401              Get required length of buffer
    402              Status + ExtAddr + ChanList + PanID  + SecLevel + PreCfgKey
    403            */
    404            len = 1 + Z_EXTADDR_LEN + 4 + 2 + 1 + SEC_KEY_LEN;
    405          
    406            buf = osal_mem_alloc( len );
   \   00000A                ; Setup parameters for call to function osal_mem_alloc
   \   00000A   7A20         MOV     R2,#0x20
   \   00000C   7B00         MOV     R3,#0x0
   \   00000E   12....       LCALL   ??osal_mem_alloc?relay
   \   000011   8A..         MOV     ?V0 + 0,R2
   \   000013   8B..         MOV     ?V0 + 1,R3
   \   000015   AE..         MOV     R6,?V0 + 0
   \   000017   AF..         MOV     R7,?V0 + 1
    407            if ( buf )
   \   000019   EE           MOV     A,R6
   \   00001A   4F           ORL     A,R7
   \   00001B   7003         JNZ     $+5
   \   00001D   02....       LJMP    ??MT_UtilGetNvInfo_0 & 0xFFFF
    408            {
    409              /* Assume NV not available */
    410              osal_memset( buf, 0xFF, len );
   \   000020                ; Setup parameters for call to function osal_memset
   \   000020   7C20         MOV     R4,#0x20
   \   000022   7D00         MOV     R5,#0x0
   \   000024   79FF         MOV     R1,#-0x1
   \   000026   12....       LCALL   ??osal_memset?relay
    411          
    412              /* Skip over status */
    413              pBuf = buf + 1;
   \   000029   8E82         MOV     DPL,R6
   \   00002B   8F83         MOV     DPH,R7
   \   00002D   A3           INC     DPTR
   \   00002E   8582..       MOV     ?V0 + 2,DPL
   \   000031   8583..       MOV     ?V0 + 3,DPH
    414          
    415              /* Start with 64-bit extended address */
    416              stat = osal_nv_read( ZCD_NV_EXTADDR, 0, Z_EXTADDR_LEN, pBuf );
   \   000034                ; Setup parameters for call to function osal_nv_read
   \   000034   78..         MOV     R0,#?V0 + 2
   \   000036   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000039   75..08       MOV     ?V0 + 0,#0x8
   \   00003C   75..00       MOV     ?V0 + 1,#0x0
   \   00003F   78..         MOV     R0,#?V0 + 0
   \   000041   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000044   12....       LCALL   ?Subroutine22 & 0xFFFF
   \                     ??CrossCallReturnLabel_53:
   \   000047   12....       LCALL   ?DEALLOC_XSTACK8
   \   00004A   E9           MOV     A,R1
   \   00004B   F5..         MOV     ?V0 + 0,A
    417              if ( stat ) stat = 0x01;
   \   00004D   6003         JZ      ??MT_UtilGetNvInfo_1
   \   00004F   75..01       MOV     ?V0 + 0,#0x1
    418              pBuf += Z_EXTADDR_LEN;
   \                     ??MT_UtilGetNvInfo_1:
   \   000052   E5..         MOV     A,?V0 + 2
   \   000054   2408         ADD     A,#0x8
   \   000056   F5..         MOV     ?V0 + 2,A
   \   000058   E5..         MOV     A,?V0 + 3
   \   00005A   3400         ADDC    A,#0x0
   \   00005C   F5..         MOV     ?V0 + 3,A
    419          
    420              /* Scan channel list (bit mask) */
    421              if (  osal_nv_read( ZCD_NV_CHANLIST, 0, sizeof( tmp32 ), &tmp32 ) )
   \   00005E                ; Setup parameters for call to function osal_nv_read
   \   00005E   7402         MOV     A,#0x2
   \   000060   12....       LCALL   ?XSTACK_DISP0_8
   \   000063   8582..       MOV     ?V0 + 4,DPL
   \   000066   8583..       MOV     ?V0 + 5,DPH
   \   000069   78..         MOV     R0,#?V0 + 4
   \   00006B   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00006E   75..04       MOV     ?V0 + 4,#0x4
   \   000071   75..00       MOV     ?V0 + 5,#0x0
   \   000074   78..         MOV     R0,#?V0 + 4
   \   000076   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000079   7C00         MOV     R4,#0x0
   \   00007B   7D00         MOV     R5,#0x0
   \   00007D   7A84         MOV     R2,#-0x7c
   \   00007F   12....       LCALL   ??Subroutine37_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_54:
   \   000082   12....       LCALL   ?DEALLOC_XSTACK8
   \   000085   E9           MOV     A,R1
   \   000086   6008         JZ      ??MT_UtilGetNvInfo_2
    422                stat |= 0x02;
   \   000088   E5..         MOV     A,?V0 + 0
   \   00008A   D2E1         SETB    0xE0 /* A   */.1
   \   00008C   F5..         MOV     ?V0 + 0,A
   \   00008E   8060         SJMP    ??MT_UtilGetNvInfo_3
    423              else
    424              {
    425                pBuf[0] = BREAK_UINT32( tmp32, 3 );
   \                     ??MT_UtilGetNvInfo_2:
   \   000090   7402         MOV     A,#0x2
   \   000092   12....       LCALL   ?XSTACK_DISP0_8
   \   000095   78..         MOV     R0,#?V0 + 4
   \   000097   12....       LCALL   ?L_MOV_X
   \   00009A   7418         MOV     A,#0x18
   \   00009C   78..         MOV     R0,#?V0 + 4
   \   00009E   12....       LCALL   ?UL_SHR
   \   0000A1   85..82       MOV     DPL,?V0 + 2
   \   0000A4   85..83       MOV     DPH,?V0 + 3
   \   0000A7   E5..         MOV     A,?V0 + 4
   \   0000A9   F0           MOVX    @DPTR,A
    426                pBuf[1] = BREAK_UINT32( tmp32, 2 );
   \   0000AA   7402         MOV     A,#0x2
   \   0000AC   12....       LCALL   ?XSTACK_DISP0_8
   \   0000AF   78..         MOV     R0,#?V0 + 4
   \   0000B1   12....       LCALL   ?L_MOV_X
   \   0000B4   7410         MOV     A,#0x10
   \   0000B6   78..         MOV     R0,#?V0 + 4
   \   0000B8   12....       LCALL   ?UL_SHR
   \   0000BB   85..82       MOV     DPL,?V0 + 2
   \   0000BE   85..83       MOV     DPH,?V0 + 3
   \   0000C1   A3           INC     DPTR
   \   0000C2   E5..         MOV     A,?V0 + 4
   \   0000C4   F0           MOVX    @DPTR,A
    427                pBuf[2] = BREAK_UINT32( tmp32, 1 );
   \   0000C5   7402         MOV     A,#0x2
   \   0000C7   12....       LCALL   ?XSTACK_DISP0_8
   \   0000CA   78..         MOV     R0,#?V0 + 4
   \   0000CC   12....       LCALL   ?L_MOV_X
   \   0000CF   E5..         MOV     A,?V0 + 5
   \   0000D1   85..82       MOV     DPL,?V0 + 2
   \   0000D4   85..83       MOV     DPH,?V0 + 3
   \   0000D7   A3           INC     DPTR
   \   0000D8   A3           INC     DPTR
   \   0000D9   F0           MOVX    @DPTR,A
    428                pBuf[3] = BREAK_UINT32( tmp32, 0 );
   \   0000DA   7402         MOV     A,#0x2
   \   0000DC   12....       LCALL   ?XSTACK_DISP0_8
   \   0000DF   78..         MOV     R0,#?V0 + 4
   \   0000E1   12....       LCALL   ?L_MOV_X
   \   0000E4   85..82       MOV     DPL,?V0 + 2
   \   0000E7   85..83       MOV     DPH,?V0 + 3
   \   0000EA   A3           INC     DPTR
   \   0000EB   A3           INC     DPTR
   \   0000EC   A3           INC     DPTR
   \   0000ED   E5..         MOV     A,?V0 + 4
   \   0000EF   F0           MOVX    @DPTR,A
    429              }
    430              pBuf += sizeof( tmp32 );
   \                     ??MT_UtilGetNvInfo_3:
   \   0000F0   E5..         MOV     A,?V0 + 2
   \   0000F2   2404         ADD     A,#0x4
   \   0000F4   F5..         MOV     ?V0 + 2,A
   \   0000F6   E5..         MOV     A,?V0 + 3
   \   0000F8   3400         ADDC    A,#0x0
   \   0000FA   F5..         MOV     ?V0 + 3,A
    431          
    432              /* ZigBee PanID */
    433              if ( osal_nv_read( ZCD_NV_PANID, 0, sizeof( tmp16 ), &tmp16 ) )
   \   0000FC                ; Setup parameters for call to function osal_nv_read
   \   0000FC   85..82       MOV     DPL,?XSP + 0
   \   0000FF   85..83       MOV     DPH,?XSP + 1
   \   000102   8582..       MOV     ?V0 + 4,DPL
   \   000105   8583..       MOV     ?V0 + 5,DPH
   \   000108   78..         MOV     R0,#?V0 + 4
   \   00010A   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00010D   75..02       MOV     ?V0 + 4,#0x2
   \   000110   75..00       MOV     ?V0 + 5,#0x0
   \   000113   78..         MOV     R0,#?V0 + 4
   \   000115   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000118   7C00         MOV     R4,#0x0
   \   00011A   7D00         MOV     R5,#0x0
   \   00011C   7A83         MOV     R2,#-0x7d
   \   00011E   12....       LCALL   ??Subroutine37_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_55:
   \   000121   12....       LCALL   ?DEALLOC_XSTACK8
   \   000124   E9           MOV     A,R1
   \   000125   6008         JZ      ??MT_UtilGetNvInfo_4
    434                stat |= 0x04;
   \   000127   E5..         MOV     A,?V0 + 0
   \   000129   D2E2         SETB    0xE0 /* A   */.2
   \   00012B   F5..         MOV     ?V0 + 0,A
   \   00012D   801E         SJMP    ??MT_UtilGetNvInfo_5
    435              else
    436              {
    437                pBuf[0] = LO_UINT16( tmp16 );
   \                     ??MT_UtilGetNvInfo_4:
   \   00012F   85..82       MOV     DPL,?XSP + 0
   \   000132   85..83       MOV     DPH,?XSP + 1
   \   000135   E0           MOVX    A,@DPTR
   \   000136   85..82       MOV     DPL,?V0 + 2
   \   000139   85..83       MOV     DPH,?V0 + 3
   \   00013C   F0           MOVX    @DPTR,A
    438                pBuf[1] = HI_UINT16( tmp16 );
   \   00013D   85..82       MOV     DPL,?XSP + 0
   \   000140   85..83       MOV     DPH,?XSP + 1
   \   000143   A3           INC     DPTR
   \   000144   E0           MOVX    A,@DPTR
   \   000145   85..82       MOV     DPL,?V0 + 2
   \   000148   85..83       MOV     DPH,?V0 + 3
   \   00014B   A3           INC     DPTR
   \   00014C   F0           MOVX    @DPTR,A
    439              }
    440              pBuf += sizeof( tmp16 );
   \                     ??MT_UtilGetNvInfo_5:
   \   00014D   E5..         MOV     A,?V0 + 2
   \   00014F   2402         ADD     A,#0x2
   \   000151   F5..         MOV     ?V0 + 2,A
   \   000153   E5..         MOV     A,?V0 + 3
   \   000155   3400         ADDC    A,#0x0
   \   000157   F5..         MOV     ?V0 + 3,A
    441          
    442              /* Security level */
    443              if ( osal_nv_read( ZCD_NV_SECURITY_LEVEL, 0, sizeof( uint8 ), pBuf++ ) )
   \   000159                ; Setup parameters for call to function osal_nv_read
   \   000159   78..         MOV     R0,#?V0 + 2
   \   00015B   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00015E   75..01       MOV     ?V0 + 4,#0x1
   \   000161   78..         MOV     R0,#?V0 + 4
   \   000163   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000166   7C00         MOV     R4,#0x0
   \   000168   7D00         MOV     R5,#0x0
   \   00016A   7A61         MOV     R2,#0x61
   \   00016C   12....       LCALL   ??Subroutine37_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_56:
   \   00016F   12....       LCALL   ?DEALLOC_XSTACK8
   \   000172   E9           MOV     A,R1
   \   000173   85..82       MOV     DPL,?V0 + 2
   \   000176   85..83       MOV     DPH,?V0 + 3
   \   000179   A3           INC     DPTR
   \   00017A   8582..       MOV     ?V0 + 2,DPL
   \   00017D   8583..       MOV     ?V0 + 3,DPH
   \   000180   6006         JZ      ??MT_UtilGetNvInfo_6
    444                stat |= 0x08;
   \   000182   E5..         MOV     A,?V0 + 0
   \   000184   D2E3         SETB    0xE0 /* A   */.3
   \   000186   F5..         MOV     ?V0 + 0,A
    445          
    446              /* Pre-configured security key */
    447              if ( osal_nv_read( ZCD_NV_PRECFGKEY, 0, SEC_KEY_LEN, pBuf ) )
   \                     ??MT_UtilGetNvInfo_6:
   \   000188                ; Setup parameters for call to function osal_nv_read
   \   000188   78..         MOV     R0,#?V0 + 2
   \   00018A   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00018D   75..10       MOV     ?V0 + 2,#0x10
   \   000190   75..00       MOV     ?V0 + 3,#0x0
   \   000193   78..         MOV     R0,#?V0 + 2
   \   000195   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000198   7C00         MOV     R4,#0x0
   \   00019A   7D00         MOV     R5,#0x0
   \   00019C   7A62         MOV     R2,#0x62
   \   00019E   12....       LCALL   ??Subroutine37_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_57:
   \   0001A1   12....       LCALL   ?DEALLOC_XSTACK8
   \   0001A4   E9           MOV     A,R1
   \   0001A5   6006         JZ      ??MT_UtilGetNvInfo_7
    448                stat |= 0x10;
   \   0001A7   E5..         MOV     A,?V0 + 0
   \   0001A9   D2E4         SETB    0xE0 /* A   */.4
   \   0001AB   F5..         MOV     ?V0 + 0,A
    449          
    450              /* Status bit mask - bit=1 indicates failure */
    451              *buf = stat;
   \                     ??MT_UtilGetNvInfo_7:
   \   0001AD   8E82         MOV     DPL,R6
   \   0001AF   8F83         MOV     DPH,R7
   \   0001B1   E5..         MOV     A,?V0 + 0
   \   0001B3   F0           MOVX    @DPTR,A
    452          
    453              MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_UTIL), MT_UTIL_GET_NV_INFO,
    454                                            len, buf );
   \   0001B4                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   0001B4   EE           MOV     A,R6
   \   0001B5   FC           MOV     R4,A
   \   0001B6   EF           MOV     A,R7
   \   0001B7   FD           MOV     R5,A
   \   0001B8   7B20         MOV     R3,#0x20
   \   0001BA   7A01         MOV     R2,#0x1
   \   0001BC   7967         MOV     R1,#0x67
   \   0001BE   12....       LCALL   ??MT_BuildAndSendZToolResponse?relay
    455          
    456              osal_mem_free( buf );
   \   0001C1                ; Setup parameters for call to function osal_mem_free
   \   0001C1   EE           MOV     A,R6
   \   0001C2   FA           MOV     R2,A
   \   0001C3   EF           MOV     A,R7
   \   0001C4   FB           MOV     R3,A
   \   0001C5   12....       LCALL   ??osal_mem_free?relay
    457            }
    458          }
   \                     ??MT_UtilGetNvInfo_0:
   \   0001C8   7406         MOV     A,#0x6
   \   0001CA   02....       LJMP    ?Subroutine0 & 0xFFFF
    459          
    460          /***************************************************************************************************
    461           * @fn      MT_UtilSetPanID
    462           *
    463           * @brief   Set PanID message
    464           *
    465           * @param   pBuf - pointer to the data
    466           *
    467           * @return  void
    468           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    469          void MT_UtilSetPanID(uint8 *pBuf)
   \                     MT_UtilSetPanID:
    470          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 3
   \   000005   74FD         MOV     A,#-0x3
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
    471            uint16 temp16;
    472            uint8 retValue = ZFailure;
   \   00000A   12....       LCALL   ?Subroutine7 & 0xFFFF
    473            uint8 cmdId;
    474          
    475            /* parse header */
    476            cmdId = pBuf[MT_RPC_POS_CMD1];
    477            pBuf += MT_RPC_FRAME_HDR_SZ;
    478          
    479            temp16 = BUILD_UINT16(pBuf[0], pBuf[1]);
   \                     ??CrossCallReturnLabel_4:
   \   00000D   FC           MOV     R4,A
   \   00000E   A3           INC     DPTR
   \   00000F   E0           MOVX    A,@DPTR
   \   000010   F9           MOV     R1,A
   \   000011   EC           MOV     A,R4
   \   000012   F8           MOV     R0,A
   \   000013   7401         MOV     A,#0x1
   \   000015   12....       LCALL   ?XSTACK_DISP0_8
   \   000018   E8           MOV     A,R0
   \   000019   F0           MOVX    @DPTR,A
   \   00001A   A3           INC     DPTR
   \   00001B   E9           MOV     A,R1
   \   00001C   F0           MOVX    @DPTR,A
    480            pBuf += sizeof(uint16);
    481          
    482          #if defined(NV_RESTORE)
    483            _NIB.nwkPanId = temp16;
   \   00001D   7401         MOV     A,#0x1
   \   00001F   12....       LCALL   ?XSTACK_DISP0_8
   \   000022   E0           MOVX    A,@DPTR
   \   000023   90....       MOV     DPTR,#_NIB + 33
   \   000026   F0           MOVX    @DPTR,A
   \   000027   A3           INC     DPTR
   \   000028   E9           MOV     A,R1
   \   000029   12....       LCALL   ?Subroutine24 & 0xFFFF
    484            NLME_UpdateNV(NWK_NV_NIB_ENABLE);//czvf ÒòÎªÊÇNV_RESTORE,µÄ¹ØÏµ£¬ËùÒÔÒª¸üÐÂNIB,
    485          #endif
    486            retValue = osal_nv_write(ZCD_NV_PANID, 0, osal_nv_item_len( ZCD_NV_PANID ), &temp16);
   \                     ??CrossCallReturnLabel_31:
   \   00002C   12....       LCALL   ?XSTACK_DISP0_8
   \   00002F   8582..       MOV     ?V0 + 0,DPL
   \   000032   8583..       MOV     ?V0 + 1,DPH
   \   000035   78..         MOV     R0,#?V0 + 0
   \   000037   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00003A                ; Setup parameters for call to function osal_nv_item_len
   \   00003A   7A83         MOV     R2,#-0x7d
   \   00003C   12....       LCALL   ?Subroutine25 & 0xFFFF
   \                     ??CrossCallReturnLabel_33:
   \   00003F   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000042   7C00         MOV     R4,#0x0
   \   000044   7D00         MOV     R5,#0x0
   \   000046   7A83         MOV     R2,#-0x7d
   \   000048   7B00         MOV     R3,#0x0
   \   00004A   12....       LCALL   ??osal_nv_write?relay
   \   00004D   7404         MOV     A,#0x4
   \   00004F   12....       LCALL   ?DEALLOC_XSTACK8
   \   000052   12....       LCALL   ?Subroutine19 & 0xFFFF
    487          
    488            /* Build and send back the response */
    489            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_UTIL), cmdId, 1, &retValue);
    490          #if defined (NV_RESTORE)  
    491            SystemResetSoft();
   \                     ??CrossCallReturnLabel_25:
   \   000055                ; Setup parameters for call to function Onboard_soft_reset
   \   000055   12....       LCALL   Onboard_soft_reset & 0xFFFF
    492          #endif
    493          }
   \   000058   7403         MOV     A,#0x3
   \   00005A   02....       LJMP    ??Subroutine39_0 & 0xFFFF

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine24:
   \   000000   F0           MOVX    @DPTR,A
   \   000001                ; Setup parameters for call to function NLME_UpdateNV
   \   000001                ; Setup parameters for call to function NLME_UpdateNV
   \   000001   7901         MOV     R1,#0x1
   \   000003   12....       LCALL   ??NLME_UpdateNV?relay
   \   000006                ; Setup parameters for call to function osal_nv_write
   \   000006                ; Setup parameters for call to function osal_nv_write
   \   000006   7401         MOV     A,#0x1
   \   000008   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine39_0:
   \   000000   12....       LCALL   ?DEALLOC_XSTACK8
   \   000003   7F02         MOV     R7,#0x2
   \   000005   02....       LJMP    ?BANKED_LEAVE_XDATA

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine25:
   \   000000   7B00         MOV     R3,#0x0
   \   000002   12....       LCALL   ??osal_nv_item_len?relay
   \   000005   8A..         MOV     ?V0 + 0,R2
   \   000007   8B..         MOV     ?V0 + 1,R3
   \   000009   78..         MOV     R0,#?V0 + 0
   \   00000B   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine19:
   \   000000   E9           MOV     A,R1
   \   000001   85..82       MOV     DPL,?XSP + 0
   \   000004   85..83       MOV     DPH,?XSP + 1
   \   000007   F0           MOVX    @DPTR,A
   \   000008                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   000008                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   000008                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   000008   AC82         MOV     R4,DPL
   \   00000A   AD83         MOV     R5,DPH
   \   00000C   7B01         MOV     R3,#0x1
   \   00000E   EE           MOV     A,R6
   \   00000F   FA           MOV     R2,A
   \   000010   7967         MOV     R1,#0x67
   \   000012   12....       LCALL   ??MT_BuildAndSendZToolResponse?relay
   \   000015   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine7:
   \   000000   12....       LCALL   ?Subroutine33 & 0xFFFF
   \                     ??CrossCallReturnLabel_49:
   \   000003   12....       LCALL   ?Subroutine29 & 0xFFFF
   \                     ??CrossCallReturnLabel_41:
   \   000006   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine33:
   \   000000   85..82       MOV     DPL,?XSP + 0
   \   000003   85..83       MOV     DPH,?XSP + 1
   \   000006   7401         MOV     A,#0x1
   \   000008   F0           MOVX    @DPTR,A
   \   000009   8A82         MOV     DPL,R2
   \   00000B   8B83         MOV     DPH,R3
   \   00000D   A3           INC     DPTR
   \   00000E   A3           INC     DPTR
   \   00000F   E0           MOVX    A,@DPTR
   \   000010   FE           MOV     R6,A
   \   000011   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine29:
   \   000000   EA           MOV     A,R2
   \   000001   2403         ADD     A,#0x3
   \   000003   0A           INC     R2
   \   000004   0A           INC     R2
   \   000005   0A           INC     R2
   \   000006   EB           MOV     A,R3
   \   000007   3400         ADDC    A,#0x0
   \   000009   FB           MOV     R3,A
   \   00000A   8A82         MOV     DPL,R2
   \   00000C   8B83         MOV     DPH,R3
   \   00000E   E0           MOVX    A,@DPTR
   \   00000F   22           RET
    494          
    495          /***************************************************************************************************
    496           * @fn      MT_UtilSetChannels
    497           *
    498           * @brief   Set Channels
    499           *
    500           * @param   pBuf - pointer to the data
    501           *
    502           * @return  void
    503           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    504          void MT_UtilSetChannels(uint8 *pBuf)
   \                     MT_UtilSetChannels:
    505          {
   \   000000   74EC         MOV     A,#-0x14
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 20
   \   000005                ; Auto size: 5
   \   000005   74FB         MOV     A,#-0x5
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   EA           MOV     A,R2
   \   00000B   FE           MOV     R6,A
   \   00000C   EB           MOV     A,R3
   \   00000D   FF           MOV     R7,A
    506            uint32 tmp32;
    507            uint8 retValue = ZFailure;
   \   00000E   85..82       MOV     DPL,?XSP + 0
   \   000011   85..83       MOV     DPH,?XSP + 1
   \   000014   7401         MOV     A,#0x1
   \   000016   F0           MOVX    @DPTR,A
    508            uint8 cmdId;
    509          
    510            /* parse header */
    511            cmdId = pBuf[MT_RPC_POS_CMD1];
   \   000017   12....       LCALL   ?Subroutine16 & 0xFFFF
    512            pBuf += MT_RPC_FRAME_HDR_SZ;
    513          
    514            tmp32 = BUILD_UINT32(pBuf[0], pBuf[1], pBuf[2], pBuf[3]);
   \                     ??CrossCallReturnLabel_21:
   \   00001A   8E82         MOV     DPL,R6
   \   00001C   8F83         MOV     DPH,R7
   \   00001E   E0           MOVX    A,@DPTR
   \   00001F   F5..         MOV     ?V0 + 4,A
   \   000021   E4           CLR     A
   \   000022   F5..         MOV     ?V0 + 5,A
   \   000024   F5..         MOV     ?V0 + 6,A
   \   000026   F5..         MOV     ?V0 + 7,A
   \   000028   A3           INC     DPTR
   \   000029   E0           MOVX    A,@DPTR
   \   00002A   F5..         MOV     ?V0 + 8,A
   \   00002C   E4           CLR     A
   \   00002D   F5..         MOV     ?V0 + 9,A
   \   00002F   F5..         MOV     ?V0 + 10,A
   \   000031   F5..         MOV     ?V0 + 11,A
   \   000033   7408         MOV     A,#0x8
   \   000035   78..         MOV     R0,#?V0 + 8
   \   000037   12....       LCALL   ?L_SHL
   \   00003A   78..         MOV     R0,#?V0 + 4
   \   00003C   79..         MOV     R1,#?V0 + 8
   \   00003E   12....       LCALL   ?L_ADD
   \   000041   8E82         MOV     DPL,R6
   \   000043   8F83         MOV     DPH,R7
   \   000045   A3           INC     DPTR
   \   000046   A3           INC     DPTR
   \   000047   E0           MOVX    A,@DPTR
   \   000048   F5..         MOV     ?V0 + 8,A
   \   00004A   E4           CLR     A
   \   00004B   F5..         MOV     ?V0 + 9,A
   \   00004D   7410         MOV     A,#0x10
   \   00004F   78..         MOV     R0,#?V0 + 8
   \   000051   12....       LCALL   ?L_SHL
   \   000054   78..         MOV     R0,#?V0 + 4
   \   000056   79..         MOV     R1,#?V0 + 8
   \   000058   12....       LCALL   ?L_ADD
   \   00005B   8E82         MOV     DPL,R6
   \   00005D   8F83         MOV     DPH,R7
   \   00005F   A3           INC     DPTR
   \   000060   A3           INC     DPTR
   \   000061   A3           INC     DPTR
   \   000062   E0           MOVX    A,@DPTR
   \   000063   F5..         MOV     ?V0 + 8,A
   \   000065   E4           CLR     A
   \   000066   F5..         MOV     ?V0 + 10,A
   \   000068   7418         MOV     A,#0x18
   \   00006A   78..         MOV     R0,#?V0 + 8
   \   00006C   12....       LCALL   ?L_SHL
   \   00006F   78..         MOV     R0,#?V0 + 4
   \   000071   79..         MOV     R1,#?V0 + 8
   \   000073   12....       LCALL   ?L_ADD
   \   000076   7401         MOV     A,#0x1
   \   000078   12....       LCALL   ?XSTACK_DISP0_8
   \   00007B   78..         MOV     R0,#?V0 + 4
   \   00007D   12....       LCALL   ?L_MOV_TO_X
    515          #if defined(NV_RESTORE)
    516            _NIB.channelList = tmp32; //czv7
   \   000080   7401         MOV     A,#0x1
   \   000082   12....       LCALL   ?XSTACK_DISP0_8
   \   000085   12....       LCALL   ?XLOAD_R2345
   \   000088   90....       MOV     DPTR,#_NIB + 36
   \   00008B   12....       LCALL   ?XSTORE_R2345
    517            _NIB.nwkLogicalChannel= pBuf[4];
   \   00008E   8E82         MOV     DPL,R6
   \   000090   8F83         MOV     DPH,R7
   \   000092   A3           INC     DPTR
   \   000093   A3           INC     DPTR
   \   000094   A3           INC     DPTR
   \   000095   A3           INC     DPTR
   \   000096   E0           MOVX    A,@DPTR
   \   000097   90....       MOV     DPTR,#_NIB + 22
   \   00009A   12....       LCALL   ?Subroutine24 & 0xFFFF
    518            NLME_UpdateNV(NWK_NV_NIB_ENABLE);
    519          #endif
    520            retValue = osal_nv_write(ZCD_NV_CHANLIST, 0, osal_nv_item_len( ZCD_NV_CHANLIST ), &tmp32);
   \                     ??CrossCallReturnLabel_32:
   \   00009D   12....       LCALL   ?XSTACK_DISP0_8
   \   0000A0   8582..       MOV     ?V0 + 2,DPL
   \   0000A3   8583..       MOV     ?V0 + 3,DPH
   \   0000A6   78..         MOV     R0,#?V0 + 2
   \   0000A8   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0000AB                ; Setup parameters for call to function osal_nv_item_len
   \   0000AB   7A84         MOV     R2,#-0x7c
   \   0000AD   7B00         MOV     R3,#0x0
   \   0000AF   12....       LCALL   ??osal_nv_item_len?relay
   \   0000B2   8A..         MOV     ?V0 + 2,R2
   \   0000B4   8B..         MOV     ?V0 + 3,R3
   \   0000B6   78..         MOV     R0,#?V0 + 2
   \   0000B8   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0000BB   7C00         MOV     R4,#0x0
   \   0000BD   7D00         MOV     R5,#0x0
   \   0000BF   7A84         MOV     R2,#-0x7c
   \   0000C1   7B00         MOV     R3,#0x0
   \   0000C3   12....       LCALL   ??osal_nv_write?relay
   \   0000C6   7404         MOV     A,#0x4
   \   0000C8   12....       LCALL   ?DEALLOC_XSTACK8
   \   0000CB   12....       LCALL   ?Subroutine20 & 0xFFFF
    521          
    522            /* Build and send back the response */
    523            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_UTIL), cmdId, 1, &retValue);
   \                     ??CrossCallReturnLabel_59:
   \   0000CE   AA..         MOV     R2,?V0 + 0
   \   0000D0   7967         MOV     R1,#0x67
   \   0000D2   12....       LCALL   ??MT_BuildAndSendZToolResponse?relay
    524          }
   \   0000D5   7405         MOV     A,#0x5
   \   0000D7   12....       LCALL   ?DEALLOC_XSTACK8
   \   0000DA   7F0C         MOV     R7,#0xc
   \   0000DC   02....       LJMP    ?BANKED_LEAVE_XDATA

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine20:
   \   000000   E9           MOV     A,R1
   \   000001   85..82       MOV     DPL,?XSP + 0
   \   000004   85..83       MOV     DPH,?XSP + 1
   \   000007                REQUIRE ??Subroutine38_0
   \   000007                ; // Fall through to label ??Subroutine38_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine38_0:
   \   000000   F0           MOVX    @DPTR,A
   \   000001                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   000001                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   000001                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   000001                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   000001                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   000001                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   000001                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   000001   AC82         MOV     R4,DPL
   \   000003   AD83         MOV     R5,DPH
   \   000005   7B01         MOV     R3,#0x1
   \   000007   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine16:
   \   000000   8E82         MOV     DPL,R6
   \   000002   8F83         MOV     DPH,R7
   \   000004   A3           INC     DPTR
   \   000005   A3           INC     DPTR
   \   000006   E0           MOVX    A,@DPTR
   \   000007   F5..         MOV     ?V0 + 0,A
   \   000009   EE           MOV     A,R6
   \   00000A   2403         ADD     A,#0x3
   \   00000C   0E           INC     R6
   \   00000D   0E           INC     R6
   \   00000E   0E           INC     R6
   \   00000F   EF           MOV     A,R7
   \   000010   3400         ADDC    A,#0x0
   \   000012   FF           MOV     R7,A
   \   000013   22           RET
    525          
    526          /***************************************************************************************************
    527           * @fn      MT_UtilSetSecLevel
    528           *
    529           * @brief   Set Sec Level
    530           *
    531           * @param   byte *msg - pointer to the data
    532           *
    533           * @return  void
    534           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    535          void MT_UtilSetSecLevel(uint8 *pBuf)
   \                     MT_UtilSetSecLevel:
    536          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 1
   \   000005   74FF         MOV     A,#-0x1
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
    537            uint8 retValue = ZFailure;
   \   00000A   12....       LCALL   ?Subroutine13 & 0xFFFF
    538            uint8 cmdId;
    539          
    540            /* parse header */
    541            cmdId = pBuf[MT_RPC_POS_CMD1];
    542            pBuf += MT_RPC_FRAME_HDR_SZ;
    543          
    544            retValue = osal_nv_write( ZCD_NV_SECURITY_LEVEL, 0, osal_nv_item_len( ZCD_NV_SECURITY_LEVEL ), pBuf);
   \                     ??CrossCallReturnLabel_15:
   \   00000D   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000010                ; Setup parameters for call to function osal_nv_item_len
   \   000010   7A61         MOV     R2,#0x61
   \   000012   12....       LCALL   ?Subroutine25 & 0xFFFF
   \                     ??CrossCallReturnLabel_34:
   \   000015   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000018   7C00         MOV     R4,#0x0
   \   00001A   7D00         MOV     R5,#0x0
   \   00001C   7A61         MOV     R2,#0x61
   \   00001E                REQUIRE ?Subroutine1
   \   00001E                ; // Fall through to label ?Subroutine1
    545          
    546            /* Build and send back the response */
    547            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_UTIL), cmdId, 1, &retValue );
    548          
    549          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine1:
   \   000000   7B00         MOV     R3,#0x0
   \   000002   12....       LCALL   ??osal_nv_write?relay
   \   000005   7404         MOV     A,#0x4
   \   000007   12....       LCALL   ?DEALLOC_XSTACK8
   \   00000A   12....       LCALL   ?Subroutine19 & 0xFFFF
   \                     ??CrossCallReturnLabel_26:
   \   00000D   7401         MOV     A,#0x1
   \   00000F                REQUIRE ??Subroutine39_0
   \   00000F                ; // Fall through to label ??Subroutine39_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine13:
   \   000000   12....       LCALL   ?Subroutine33 & 0xFFFF
   \                     ??CrossCallReturnLabel_48:
   \   000003                ; Setup parameters for call to function osal_nv_write
   \   000003                ; Setup parameters for call to function osal_nv_write
   \   000003   EA           MOV     A,R2
   \   000004   2403         ADD     A,#0x3
   \   000006   F5..         MOV     ?V0 + 0,A
   \   000008   EB           MOV     A,R3
   \   000009   3400         ADDC    A,#0x0
   \   00000B   F5..         MOV     ?V0 + 1,A
   \   00000D   78..         MOV     R0,#?V0 + 0
   \   00000F   22           RET
    550          
    551          /***************************************************************************************************
    552           * @fn      MT_UtilSetPreCfgKey
    553           *
    554           * @brief   Set Pre Cfg Key
    555           *
    556           * @param   pBuf - pointer to the data
    557           *
    558           * @return  void
    559           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    560          void MT_UtilSetPreCfgKey(uint8 *pBuf)
   \                     MT_UtilSetPreCfgKey:
    561          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 1
   \   000005   74FF         MOV     A,#-0x1
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
    562            uint8 retValue = ZFailure;
   \   00000A   12....       LCALL   ?Subroutine13 & 0xFFFF
    563            uint8 cmdId;
    564          
    565            /* parse header */
    566            cmdId = pBuf[MT_RPC_POS_CMD1];
    567            pBuf += MT_RPC_FRAME_HDR_SZ;
    568          
    569            retValue = osal_nv_write( ZCD_NV_PRECFGKEY, 0, osal_nv_item_len( ZCD_NV_PRECFGKEY ), pBuf);
   \                     ??CrossCallReturnLabel_16:
   \   00000D   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000010                ; Setup parameters for call to function osal_nv_item_len
   \   000010   7A62         MOV     R2,#0x62
   \   000012   12....       LCALL   ?Subroutine25 & 0xFFFF
   \                     ??CrossCallReturnLabel_35:
   \   000015   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000018   7C00         MOV     R4,#0x0
   \   00001A   7D00         MOV     R5,#0x0
   \   00001C   7A62         MOV     R2,#0x62
   \   00001E   80..         SJMP    ?Subroutine1
    570          
    571            /* Build and send back the response */
    572            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_UTIL), cmdId, 1, &retValue );
    573          
    574          }
    575          
    576          /***************************************************************************************************
    577           * @fn      MT_UtilCallbackSub
    578           *
    579           * @brief   The Callback subscribe.
    580           *
    581           * @param   pBuf - pointer to the data
    582           *
    583           * @return  void
    584           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    585          void MT_UtilCallbackSub(uint8 *pBuf)
   \                     MT_UtilCallbackSub:
    586          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 1
   \   000005   74FF         MOV     A,#-0x1
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
    587            uint8 cmdId = pBuf[MT_RPC_POS_CMD1];
   \   00000A   8A82         MOV     DPL,R2
   \   00000C   8B83         MOV     DPH,R3
   \   00000E   A3           INC     DPTR
   \   00000F   A3           INC     DPTR
   \   000010   E0           MOVX    A,@DPTR
   \   000011   FE           MOV     R6,A
    588            uint8 retValue = ZFailure;
    589          
    590          #if defined(MT_MAC_CB_FUNC) || defined(MT_NWK_CB_FUNC) || defined(MT_ZDO_CB_FUNC) || defined(MT_AF_CB_FUNC) || defined(MT_SAPI_CB_FUNC)
    591            uint8 subSystem;
    592            uint16 subscribed_command;
    593          
    594            // Move past header
    595            retValue = ZSuccess;
   \   000012   85..82       MOV     DPL,?XSP + 0
   \   000015   85..83       MOV     DPH,?XSP + 1
   \   000018   E4           CLR     A
   \   000019   F0           MOVX    @DPTR,A
    596            pBuf += MT_RPC_FRAME_HDR_SZ;
   \   00001A   12....       LCALL   ?Subroutine29 & 0xFFFF
    597          
    598            /* Command */
    599            subscribed_command = BUILD_UINT16(pBuf[0], pBuf[1]);
   \                     ??CrossCallReturnLabel_40:
   \   00001D   FC           MOV     R4,A
   \   00001E   A3           INC     DPTR
   \   00001F   E0           MOVX    A,@DPTR
   \   000020   F9           MOV     R1,A
   \   000021   EC           MOV     A,R4
   \   000022   2400         ADD     A,#0x0
   \   000024   F8           MOV     R0,A
   \   000025   E4           CLR     A
   \   000026   39           ADDC    A,R1
    600            pBuf += 2;
    601          
    602            /* Subsystem - 5 bits on the MSB of the command */
    603            subSystem = HI_UINT16(subscribed_command) & 0x1F ;
   \   000027   541F         ANL     A,#0x1f
   \   000029   FF           MOV     R7,A
    604          
    605            /* What is the action - SUBSCRIBE or !SUBSCRIBE */
    606            if (*pBuf)
   \   00002A   8A82         MOV     DPL,R2
   \   00002C   8B83         MOV     DPH,R3
   \   00002E   A3           INC     DPTR
   \   00002F   A3           INC     DPTR
   \   000030   E0           MOVX    A,@DPTR
   \   000031   6048         JZ      ??MT_UtilCallbackSub_0
    607            {
    608              /* Turn ON */
    609            #if defined( MT_MAC_CB_FUNC )
    610              if ((subSystem == MT_RPC_SYS_MAC) || (subscribed_command == 0xFFFF))
    611                _macCallbackSub = 0xFFFF;
    612            #endif
    613          
    614            #if defined( MT_NWK_CB_FUNC )
    615              if ((subSystem == MT_RPC_SYS_NWK) || (subscribed_command == 0xFFFF))
   \   000033   7403         MOV     A,#0x3
   \   000035   6F           XRL     A,R7
   \   000036   600A         JZ      ??MT_UtilCallbackSub_1
   \   000038   74FF         MOV     A,#-0x1
   \   00003A   68           XRL     A,R0
   \   00003B   7003         JNZ     ??MT_UtilCallbackSub_2
   \   00003D   74FF         MOV     A,#-0x1
   \   00003F   69           XRL     A,R1
   \                     ??MT_UtilCallbackSub_2:
   \   000040   7008         JNZ     ??MT_UtilCallbackSub_3
    616                _nwkCallbackSub = 0xFFFF;
   \                     ??MT_UtilCallbackSub_1:
   \   000042   90....       MOV     DPTR,#_nwkCallbackSub
   \   000045   74FF         MOV     A,#-0x1
   \   000047   F0           MOVX    @DPTR,A
   \   000048   A3           INC     DPTR
   \   000049   F0           MOVX    @DPTR,A
    617            #endif
    618          
    619            #if defined( MT_ZDO_CB_FUNC )
    620              if ((subSystem == MT_RPC_SYS_ZDO) || (subscribed_command == 0xFFFF))
   \                     ??MT_UtilCallbackSub_3:
   \   00004A   7405         MOV     A,#0x5
   \   00004C   6F           XRL     A,R7
   \   00004D   600A         JZ      ??MT_UtilCallbackSub_4
   \   00004F   74FF         MOV     A,#-0x1
   \   000051   68           XRL     A,R0
   \   000052   7003         JNZ     ??MT_UtilCallbackSub_5
   \   000054   74FF         MOV     A,#-0x1
   \   000056   69           XRL     A,R1
   \                     ??MT_UtilCallbackSub_5:
   \   000057   700C         JNZ     ??MT_UtilCallbackSub_6
    621                _zdoCallbackSub = 0xFFFFFFFF;
   \                     ??MT_UtilCallbackSub_4:
   \   000059   90....       MOV     DPTR,#__Constant_ffffffff
   \   00005C   12....       LCALL   ?XLOAD_R2345
   \   00005F   90....       MOV     DPTR,#_zdoCallbackSub
   \   000062   12....       LCALL   ?XSTORE_R2345
    622            #endif
    623          
    624            #if defined( MT_AF_CB_FUNC )
    625              if ((subSystem == MT_RPC_SYS_AF) || (subscribed_command == 0xFFFF))
   \                     ??MT_UtilCallbackSub_6:
   \   000065   7404         MOV     A,#0x4
   \   000067   6F           XRL     A,R7
   \   000068   600A         JZ      ??MT_UtilCallbackSub_7
   \   00006A   74FF         MOV     A,#-0x1
   \   00006C   68           XRL     A,R0
   \   00006D   7003         JNZ     ??MT_UtilCallbackSub_8
   \   00006F   74FF         MOV     A,#-0x1
   \   000071   69           XRL     A,R1
   \                     ??MT_UtilCallbackSub_8:
   \   000072   704E         JNZ     ??MT_UtilCallbackSub_9
    626                _afCallbackSub = 0xFFFF;
   \                     ??MT_UtilCallbackSub_7:
   \   000074   90....       MOV     DPTR,#_afCallbackSub
   \   000077   74FF         MOV     A,#-0x1
   \   000079   8044         SJMP    ??MT_UtilCallbackSub_10
    627            #endif
    628          
    629            #if defined( MT_SAPI_CB_FUNC )
    630              if ((subSystem == MT_RPC_SYS_SAPI) || (subscribed_command == 0xFFFF))
    631                _sapiCallbackSub = 0xFFFF;
    632            #endif
    633            }
    634            else
    635            {
    636              /* Turn OFF */
    637            #if defined( MT_MAC_CB_FUNC )
    638              if ((subSystem == MT_RPC_SYS_MAC) || (subscribed_command == 0xFFFF))
    639                _macCallbackSub = 0x0000;
    640            #endif
    641          
    642            #if defined( MT_NWK_CB_FUNC )
    643              if ((subSystem == MT_RPC_SYS_NWK) || (subscribed_command == 0xFFFF))
   \                     ??MT_UtilCallbackSub_0:
   \   00007B   7403         MOV     A,#0x3
   \   00007D   6F           XRL     A,R7
   \   00007E   600A         JZ      ??MT_UtilCallbackSub_11
   \   000080   74FF         MOV     A,#-0x1
   \   000082   68           XRL     A,R0
   \   000083   7003         JNZ     ??MT_UtilCallbackSub_12
   \   000085   74FF         MOV     A,#-0x1
   \   000087   69           XRL     A,R1
   \                     ??MT_UtilCallbackSub_12:
   \   000088   7007         JNZ     ??MT_UtilCallbackSub_13
    644                _nwkCallbackSub = 0x0000;
   \                     ??MT_UtilCallbackSub_11:
   \   00008A   90....       MOV     DPTR,#_nwkCallbackSub
   \   00008D   E4           CLR     A
   \   00008E   F0           MOVX    @DPTR,A
   \   00008F   A3           INC     DPTR
   \   000090   F0           MOVX    @DPTR,A
    645            #endif
    646          
    647            #if defined( MT_ZDO_CB_FUNC )
    648              if ((subSystem == MT_RPC_SYS_ZDO) || (subscribed_command == 0xFFFF))
   \                     ??MT_UtilCallbackSub_13:
   \   000091   7405         MOV     A,#0x5
   \   000093   6F           XRL     A,R7
   \   000094   600A         JZ      ??MT_UtilCallbackSub_14
   \   000096   74FF         MOV     A,#-0x1
   \   000098   68           XRL     A,R0
   \   000099   7003         JNZ     ??MT_UtilCallbackSub_15
   \   00009B   74FF         MOV     A,#-0x1
   \   00009D   69           XRL     A,R1
   \                     ??MT_UtilCallbackSub_15:
   \   00009E   700C         JNZ     ??MT_UtilCallbackSub_16
    649                _zdoCallbackSub = 0x00000000;
   \                     ??MT_UtilCallbackSub_14:
   \   0000A0   90....       MOV     DPTR,#__Constant_0
   \   0000A3   12....       LCALL   ?XLOAD_R2345
   \   0000A6   90....       MOV     DPTR,#_zdoCallbackSub
   \   0000A9   12....       LCALL   ?XSTORE_R2345
    650            #endif
    651          
    652            #if defined( MT_AF_CB_FUNC )
    653              if ((subSystem == MT_RPC_SYS_AF) || (subscribed_command == 0xFFFF))
   \                     ??MT_UtilCallbackSub_16:
   \   0000AC   7404         MOV     A,#0x4
   \   0000AE   6F           XRL     A,R7
   \   0000AF   600A         JZ      ??MT_UtilCallbackSub_17
   \   0000B1   74FF         MOV     A,#-0x1
   \   0000B3   68           XRL     A,R0
   \   0000B4   7003         JNZ     ??MT_UtilCallbackSub_18
   \   0000B6   74FF         MOV     A,#-0x1
   \   0000B8   69           XRL     A,R1
   \                     ??MT_UtilCallbackSub_18:
   \   0000B9   7007         JNZ     ??MT_UtilCallbackSub_9
    654                _afCallbackSub = 0x0000;
   \                     ??MT_UtilCallbackSub_17:
   \   0000BB   90....       MOV     DPTR,#_afCallbackSub
   \   0000BE   E4           CLR     A
   \                     ??MT_UtilCallbackSub_10:
   \   0000BF   F0           MOVX    @DPTR,A
   \   0000C0   A3           INC     DPTR
   \   0000C1   F0           MOVX    @DPTR,A
    655            #endif
    656          
    657            #if defined( MT_SAPI_CB_FUNC )
    658              if ((subSystem == MT_RPC_SYS_SAPI) || (subscribed_command == 0xFFFF))
    659                  _sapiCallbackSub = 0x0000;
    660            #endif
    661            }
    662          #endif  // MT_MAC_CB_FUNC || MT_NWK_CB_FUNC || MT_ZDO_CB_FUNC || MT_AF_CB_FUNC || MT_SAPI_CB_FUNC || MT_SAPI_CB_FUNC
    663          
    664            /* Build and send back the response */
    665            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_UTIL), cmdId, 1, &retValue );
   \                     ??MT_UtilCallbackSub_9:
   \   0000C2                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   0000C2   02....       LJMP    ?Subroutine2 & 0xFFFF
    666          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine2:
   \   000000   85..82       MOV     DPL,?XSP + 0
   \   000003   85..83       MOV     DPH,?XSP + 1
   \   000006                REQUIRE ??Subroutine40_0
   \   000006                ; // Fall through to label ??Subroutine40_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine40_0:
   \   000000   AC82         MOV     R4,DPL
   \   000002   AD83         MOV     R5,DPH
   \   000004   7B01         MOV     R3,#0x1
   \   000006   EE           MOV     A,R6
   \   000007   FA           MOV     R2,A
   \   000008   7967         MOV     R1,#0x67
   \   00000A   12....       LCALL   ??MT_BuildAndSendZToolResponse?relay
   \   00000D   7401         MOV     A,#0x1
   \   00000F                REQUIRE ??Subroutine41_0
   \   00000F                ; // Fall through to label ??Subroutine41_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine41_0:
   \   000000   12....       LCALL   ?DEALLOC_XSTACK8
   \   000003   7F01         MOV     R7,#0x1
   \   000005   02....       LJMP    ?BANKED_LEAVE_XDATA
    667          
    668          #if (defined HAL_KEY) && (HAL_KEY == TRUE)
    669          /***************************************************************************************************
    670           * @fn      MT_UtilKeyEvent
    671           *
    672           * @brief   Process Key Event
    673           *
    674           * @param   pBuf - pointer to the data
    675           *
    676           * @return  void
    677           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    678          void MT_UtilKeyEvent(uint8 *pBuf)
   \                     MT_UtilKeyEvent:
    679          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 1
   \   000005   74FF         MOV     A,#-0x1
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
    680            uint8 x = 0;
   \   00000A   7900         MOV     R1,#0x0
    681            uint8 retValue = ZFailure;
   \   00000C   12....       LCALL   ?Subroutine7 & 0xFFFF
    682            uint8 cmdId;
    683          
    684            /* parse header */
    685            cmdId = pBuf[MT_RPC_POS_CMD1];
    686            pBuf += MT_RPC_FRAME_HDR_SZ;
    687          
    688            /* Translate between SPI values to device values */
    689            if ( *pBuf & 0x01 )
   \                     ??CrossCallReturnLabel_5:
   \   00000F   A2E0         MOV     C,0xE0 /* A   */.0
   \   000011   5001         JNC     ??MT_UtilKeyEvent_0
    690              x |= HAL_KEY_SW_1;
   \   000013   09           INC     R1
    691            if ( *pBuf & 0x02 )
   \                     ??MT_UtilKeyEvent_0:
   \   000014   A2E1         MOV     C,0xE0 /* A   */.1
   \   000016   5004         JNC     ??MT_UtilKeyEvent_1
    692              x |= HAL_KEY_SW_2;
   \   000018   E9           MOV     A,R1
   \   000019   D2E1         SETB    0xE0 /* A   */.1
   \   00001B   F9           MOV     R1,A
    693            if ( *pBuf & 0x04 )
   \                     ??MT_UtilKeyEvent_1:
   \   00001C   E0           MOVX    A,@DPTR
   \   00001D   A2E2         MOV     C,0xE0 /* A   */.2
   \   00001F   5004         JNC     ??MT_UtilKeyEvent_2
    694              x |= HAL_KEY_SW_3;
   \   000021   E9           MOV     A,R1
   \   000022   D2E4         SETB    0xE0 /* A   */.4
   \   000024   F9           MOV     R1,A
    695            if ( *pBuf & 0x08 )
   \                     ??MT_UtilKeyEvent_2:
   \   000025   E0           MOVX    A,@DPTR
   \   000026   A2E3         MOV     C,0xE0 /* A   */.3
   \   000028   5004         JNC     ??MT_UtilKeyEvent_3
    696            x |= HAL_KEY_SW_4;
   \   00002A   E9           MOV     A,R1
   \   00002B   D2E3         SETB    0xE0 /* A   */.3
   \   00002D   F9           MOV     R1,A
    697          #if defined ( HAL_KEY_SW_5 )
    698            if ( *pBuf & 0x10 )
   \                     ??MT_UtilKeyEvent_3:
   \   00002E   E0           MOVX    A,@DPTR
   \   00002F   A2E4         MOV     C,0xE0 /* A   */.4
   \   000031   5004         JNC     ??MT_UtilKeyEvent_4
    699              x |= HAL_KEY_SW_5;
   \   000033   E9           MOV     A,R1
   \   000034   D2E2         SETB    0xE0 /* A   */.2
   \   000036   F9           MOV     R1,A
    700          #endif
    701          #if defined ( HAL_KEY_SW_6 )
    702            if ( *pBuf & 0x20 )
   \                     ??MT_UtilKeyEvent_4:
   \   000037   E0           MOVX    A,@DPTR
   \   000038   A2E5         MOV     C,0xE0 /* A   */.5
   \   00003A   5004         JNC     ??MT_UtilKeyEvent_5
    703              x |= HAL_KEY_SW_6;
   \   00003C   E9           MOV     A,R1
   \   00003D   D2E5         SETB    0xE0 /* A   */.5
   \   00003F   F9           MOV     R1,A
    704          #endif
    705          #if defined ( HAL_KEY_SW_7 )
    706            if ( *pBuf & 0x40 )
   \                     ??MT_UtilKeyEvent_5:
   \   000040   E0           MOVX    A,@DPTR
   \   000041   A2E6         MOV     C,0xE0 /* A   */.6
   \   000043   5004         JNC     ??MT_UtilKeyEvent_6
    707              x |= HAL_KEY_SW_7;
   \   000045   E9           MOV     A,R1
   \   000046   D2E6         SETB    0xE0 /* A   */.6
   \   000048   F9           MOV     R1,A
    708          #endif
    709          #if defined ( HAL_KEY_SW_8 )
    710            if ( *pBuf & 0x80 )
    711              x |= HAL_KEY_SW_8;
    712          #endif
    713            pBuf++;
    714          
    715            retValue = OnBoard_SendKeys(x, *pBuf);
   \                     ??MT_UtilKeyEvent_6:
   \   000049                ; Setup parameters for call to function OnBoard_SendKeys
   \   000049   A3           INC     DPTR
   \   00004A   E0           MOVX    A,@DPTR
   \   00004B   FA           MOV     R2,A
   \   00004C   12....       LCALL   ??OnBoard_SendKeys?relay
   \   00004F   E9           MOV     A,R1
   \   000050   85..82       MOV     DPL,?XSP + 0
   \   000053   85..83       MOV     DPH,?XSP + 1
   \   000056   F0           MOVX    @DPTR,A
    716          
    717            /* Build and send back the response */
    718            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_UTIL), cmdId, 1, &retValue );
   \   000057                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   000057   80..         SJMP    ??Subroutine40_0
    719          }
    720          #endif
    721          
    722          /***************************************************************************************************
    723           * @fn      MT_UtilTimeAlive
    724           *
    725           * @brief   Process Time Alive
    726           *
    727           * @param   None.
    728           *
    729           * @return  None
    730           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    731          void MT_UtilTimeAlive(void)
   \                     MT_UtilTimeAlive:
    732          {
   \   000000   74F0         MOV     A,#-0x10
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 16
   \   000005                ; Auto size: 4
   \   000005   74FC         MOV     A,#-0x4
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
    733            uint8 timeAlive[4];
    734            uint32 tmp32;
    735          
    736            /* Time since last reset (seconds) */
    737            tmp32 = osal_GetSystemClock() / 1000;
   \   00000A                ; Setup parameters for call to function osal_GetSystemClock
   \   00000A   12....       LCALL   ??osal_GetSystemClock?relay
   \   00000D   8A..         MOV     ?V0 + 4,R2
   \   00000F   8B..         MOV     ?V0 + 5,R3
   \   000011   8C..         MOV     ?V0 + 6,R4
   \   000013   8D..         MOV     ?V0 + 7,R5
   \   000015   90....       MOV     DPTR,#__Constant_3e8
   \   000018   78..         MOV     R0,#?V0 + 0
   \   00001A   12....       LCALL   ?L_MOV_X
   \   00001D   78..         MOV     R0,#?V0 + 4
   \   00001F   79..         MOV     R1,#?V0 + 0
   \   000021   12....       LCALL   ?UL_DIV_MOD
    738          
    739            /* Convert to high byte first into temp buffer */
    740            timeAlive[0] = BREAK_UINT32(tmp32, 0);
   \   000024   85..82       MOV     DPL,?XSP + 0
   \   000027   85..83       MOV     DPH,?XSP + 1
   \   00002A   E5..         MOV     A,?V0 + 4
   \   00002C   F0           MOVX    @DPTR,A
    741            timeAlive[1] = BREAK_UINT32(tmp32, 1);
   \   00002D   85....       MOV     ?V0 + 1,?V0 + 5
   \   000030   E5..         MOV     A,?V0 + 1
   \   000032   F5..         MOV     ?V0 + 0,A
   \   000034   7401         MOV     A,#0x1
   \   000036   12....       LCALL   ?XSTACK_DISP0_8
   \   000039   E5..         MOV     A,?V0 + 0
   \   00003B   F0           MOVX    @DPTR,A
    742            timeAlive[2] = BREAK_UINT32(tmp32, 2);
   \   00003C   85....       MOV     ?V0 + 0,?V0 + 4
   \   00003F   85....       MOV     ?V0 + 2,?V0 + 6
   \   000042   85....       MOV     ?V0 + 3,?V0 + 7
   \   000045   7410         MOV     A,#0x10
   \   000047   78..         MOV     R0,#?V0 + 0
   \   000049   12....       LCALL   ?UL_SHR
   \   00004C   7402         MOV     A,#0x2
   \   00004E   12....       LCALL   ?XSTACK_DISP0_8
   \   000051   E5..         MOV     A,?V0 + 0
   \   000053   F0           MOVX    @DPTR,A
    743            timeAlive[3] = BREAK_UINT32(tmp32, 3);
   \   000054   7418         MOV     A,#0x18
   \   000056   78..         MOV     R0,#?V0 + 4
   \   000058   12....       LCALL   ?UL_SHR
   \   00005B   7403         MOV     A,#0x3
   \   00005D   12....       LCALL   ?XSTACK_DISP0_8
   \   000060   E5..         MOV     A,?V0 + 4
   \   000062   12....       LCALL   ?Subroutine32 & 0xFFFF
    744          
    745            /* Build and send back the response */
    746            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_UTIL),
    747                                                 MT_UTIL_TIME_ALIVE, sizeof(timeAlive), timeAlive);
   \                     ??CrossCallReturnLabel_46:
   \   000065   7B04         MOV     R3,#0x4
   \   000067   7A09         MOV     R2,#0x9
   \   000069   7967         MOV     R1,#0x67
   \   00006B   12....       LCALL   ??MT_BuildAndSendZToolResponse?relay
    748          }
   \   00006E   7404         MOV     A,#0x4
   \   000070   02....       LJMP    ?Subroutine0 & 0xFFFF

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine32:
   \   000000   F0           MOVX    @DPTR,A
   \   000001                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   000001                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   000001                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   000001                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   000001   85..82       MOV     DPL,?XSP + 0
   \   000004   85..83       MOV     DPH,?XSP + 1
   \   000007   AC82         MOV     R4,DPL
   \   000009   AD83         MOV     R5,DPH
   \   00000B   22           RET
    749          
    750          #if (defined GUU_HAL_LED) && (GUU_HAL_LED == TRUE)// czv7 ÐÞ¸ÄHAL_LED
    751          /***************************************************************************************************
    752           * @fn      MT_UtilLedControl
    753           *
    754           * @brief   Process the LED Control Message
    755           *
    756           * @param   pBuf - pointer to the received data
    757           *
    758           * @return  None
    759           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    760          void MT_UtilLedControl(uint8 *pBuf)
   \                     MT_UtilLedControl:
    761          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 1
   \   000005   74FF         MOV     A,#-0x1
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
    762            uint8 iLed, Led, iMode, Mode, cmdId;
    763            uint8 retValue = ZFailure;
   \   00000A   12....       LCALL   ?Subroutine7 & 0xFFFF
    764          
    765            /* parse header */
    766            cmdId = pBuf[MT_RPC_POS_CMD1];
    767            pBuf += MT_RPC_FRAME_HDR_SZ;
    768          
    769            /* LED and Mode */
    770            iLed = *pBuf++;
   \                     ??CrossCallReturnLabel_6:
   \   00000D   F8           MOV     R0,A
   \   00000E   A3           INC     DPTR
    771            iMode = *pBuf;
   \   00000F   E0           MOVX    A,@DPTR
   \   000010   FA           MOV     R2,A
    772          
    773            if ( iLed == 1 )
   \   000011   7401         MOV     A,#0x1
   \   000013   68           XRL     A,R0
   \   000014   7004         JNZ     ??MT_UtilLedControl_0
    774              Led = HAL_LED_1;
   \   000016   7901         MOV     R1,#0x1
   \   000018   8026         SJMP    ??MT_UtilLedControl_1
    775            else if ( iLed == 2 )
   \                     ??MT_UtilLedControl_0:
   \   00001A   7402         MOV     A,#0x2
   \   00001C   68           XRL     A,R0
   \   00001D   7004         JNZ     ??MT_UtilLedControl_2
    776              Led = HAL_LED_2;
   \   00001F   7902         MOV     R1,#0x2
   \   000021   801D         SJMP    ??MT_UtilLedControl_1
    777            else if ( iLed == 3 )
   \                     ??MT_UtilLedControl_2:
   \   000023   7403         MOV     A,#0x3
   \   000025   68           XRL     A,R0
   \   000026   7004         JNZ     ??MT_UtilLedControl_3
    778              Led = HAL_LED_3;
   \   000028   7904         MOV     R1,#0x4
   \   00002A   8014         SJMP    ??MT_UtilLedControl_1
    779            else if ( iLed == 4 )
   \                     ??MT_UtilLedControl_3:
   \   00002C   7404         MOV     A,#0x4
   \   00002E   68           XRL     A,R0
   \   00002F   7004         JNZ     ??MT_UtilLedControl_4
    780              Led = HAL_LED_4;
   \   000031   7908         MOV     R1,#0x8
   \   000033   800B         SJMP    ??MT_UtilLedControl_1
    781            else if ( iLed == 0xFF )
   \                     ??MT_UtilLedControl_4:
   \   000035   74FF         MOV     A,#-0x1
   \   000037   68           XRL     A,R0
   \   000038   7004         JNZ     ??MT_UtilLedControl_5
    782              Led = HAL_LED_ALL;
   \   00003A   79FF         MOV     R1,#-0x1
   \   00003C   8002         SJMP    ??MT_UtilLedControl_1
    783            else
    784              Led = 0;
   \                     ??MT_UtilLedControl_5:
   \   00003E   7900         MOV     R1,#0x0
    785          
    786            if ( iMode == 0 )
   \                     ??MT_UtilLedControl_1:
   \   000040   EA           MOV     A,R2
   \   000041   7004         JNZ     ??MT_UtilLedControl_6
    787              Mode = HAL_LED_MODE_OFF;
   \   000043   7A00         MOV     R2,#0x0
   \   000045   8022         SJMP    ??MT_UtilLedControl_7
    788            else if ( iMode == 1 )
   \                     ??MT_UtilLedControl_6:
   \   000047   7401         MOV     A,#0x1
   \   000049   6A           XRL     A,R2
   \   00004A   7004         JNZ     ??MT_UtilLedControl_8
    789              Mode = HAL_LED_MODE_ON;
   \   00004C   7A01         MOV     R2,#0x1
   \   00004E   8019         SJMP    ??MT_UtilLedControl_7
    790            else if ( iMode == 2 )
   \                     ??MT_UtilLedControl_8:
   \   000050   7402         MOV     A,#0x2
   \   000052   6A           XRL     A,R2
   \   000053   7004         JNZ     ??MT_UtilLedControl_9
    791              Mode = HAL_LED_MODE_BLINK;
   \   000055   7A02         MOV     R2,#0x2
   \   000057   8010         SJMP    ??MT_UtilLedControl_7
    792            else if ( iMode == 3 )
   \                     ??MT_UtilLedControl_9:
   \   000059   7403         MOV     A,#0x3
   \   00005B   6A           XRL     A,R2
   \   00005C   7004         JNZ     ??MT_UtilLedControl_10
    793              Mode = HAL_LED_MODE_FLASH;
   \   00005E   7A04         MOV     R2,#0x4
   \   000060   8007         SJMP    ??MT_UtilLedControl_7
    794            else if ( iMode == 4 )
   \                     ??MT_UtilLedControl_10:
   \   000062   7404         MOV     A,#0x4
   \   000064   6A           XRL     A,R2
   \   000065   7010         JNZ     ??MT_UtilLedControl_11
    795              Mode = HAL_LED_MODE_TOGGLE;
   \   000067   7A08         MOV     R2,#0x8
    796            else
    797              Led = 0;
    798          
    799            if ( Led != 0 )
   \                     ??MT_UtilLedControl_7:
   \   000069   E9           MOV     A,R1
   \   00006A   600B         JZ      ??MT_UtilLedControl_11
    800            {
    801              HalLedSet (Led, Mode);
   \   00006C                ; Setup parameters for call to function HalLedSet
   \   00006C   12....       LCALL   ??HalLedSet?relay
    802              retValue = ZSuccess;
   \   00006F   85..82       MOV     DPL,?XSP + 0
   \   000072   85..83       MOV     DPH,?XSP + 1
   \   000075   E4           CLR     A
   \   000076   F0           MOVX    @DPTR,A
    803            }
    804          
    805            /* Build and send back the response */
    806            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_UTIL), cmdId, 1, &retValue );
   \                     ??MT_UtilLedControl_11:
   \   000077                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   000077   02....       LJMP    ?Subroutine2 & 0xFFFF
    807          }
    808          #endif /* HAL_LED */
    809          
    810          
    811          /***************************************************************************************************
    812           * @fn          MT_UtilSrcMatchEnable
    813           *
    814           * @brief      Enabled AUTOPEND and source address matching.
    815           *
    816           * @param      pBuf - Buffer contains the data
    817           *
    818           * @return     void
    819           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    820          void MT_UtilSrcMatchEnable (uint8 *pBuf)
   \                     MT_UtilSrcMatchEnable:
   \   000000   80..         SJMP    ?Subroutine3

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine3:
    821          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 1
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 1
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 1
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 1
   \   000004   74FF         MOV     A,#-0x1
   \   000006   12....       LCALL   ?ALLOC_XSTACK8
    822            uint8 retValue, cmdId;
    823          
    824            /* Parse header */
    825            cmdId = pBuf[MT_RPC_POS_CMD1];
   \   000009   12....       LCALL   ?Subroutine30 & 0xFFFF
    826            pBuf += MT_RPC_FRAME_HDR_SZ;
    827          
    828          #ifdef AUTO_PEND
    829            /* Call the routine */
    830            retValue = ZMacSrcMatchEnable (pBuf[0], pBuf[1]);
    831          #else
    832            retValue = ZMacUnsupported;
   \                     ??CrossCallReturnLabel_42:
   \   00000C   12....       LCALL   ??Subroutine38_0 & 0xFFFF
    833          #endif
    834          
    835            /* Build and send back the response */
    836            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_UTIL), cmdId, 1, &retValue );
   \                     ??CrossCallReturnLabel_61:
   \   00000F                REQUIRE ??Subroutine42_0
   \   00000F                ; // Fall through to label ??Subroutine42_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine42_0:
   \   000000   7967         MOV     R1,#0x67
   \   000002   12....       LCALL   ??MT_BuildAndSendZToolResponse?relay
    837          
    838          }
   \   000005   7401         MOV     A,#0x1
   \   000007                REQUIRE ??Subroutine43_0
   \   000007                ; // Fall through to label ??Subroutine43_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine43_0:
   \   000000   12....       LCALL   ?DEALLOC_XSTACK8
   \   000003   D083         POP     DPH
   \   000005   D082         POP     DPL
   \   000007   02....       LJMP    ?BRET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine30:
   \   000000   8A82         MOV     DPL,R2
   \   000002   8B83         MOV     DPH,R3
   \   000004   A3           INC     DPTR
   \   000005   A3           INC     DPTR
   \   000006   E0           MOVX    A,@DPTR
   \   000007   FA           MOV     R2,A
   \   000008   85..82       MOV     DPL,?XSP + 0
   \   00000B   85..83       MOV     DPH,?XSP + 1
   \   00000E   74F5         MOV     A,#-0xb
   \   000010   22           RET
    839          
    840          /***************************************************************************************************
    841           * @fn          MT_UtilSrcMatchAddEntry
    842           *
    843           * @brief       Add a short or extended address to source address table.
    844           *
    845           * @param       pBuf - Buffer contains the data
    846           *
    847           * @return      void
    848           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    849          void MT_UtilSrcMatchAddEntry (uint8 *pBuf)
   \                     MT_UtilSrcMatchAddEntry:
   \   000000   80..         SJMP    ?Subroutine3
    850          {
    851            uint8 retValue, cmdId;
    852          
    853            /* Parse header */
    854            cmdId = pBuf[MT_RPC_POS_CMD1];
    855            pBuf += MT_RPC_FRAME_HDR_SZ;
    856          
    857          #ifdef AUTO_PEND
    858            uint16 panID;
    859            zAddrType_t devAddr;
    860          
    861            /* Address mode */
    862            devAddr.addrMode = *pBuf++;
    863          
    864            /* Address based on the address mode */
    865            MT_UtilSpi2Addr( &devAddr, pBuf);
    866            pBuf += Z_EXTADDR_LEN;
    867          
    868            /* PanID */
    869            panID = BUILD_UINT16( pBuf[0] , pBuf[1] );
    870          
    871            /* Call the routine */
    872            retValue =  ZMacSrcMatchAddEntry (&devAddr, panID);
    873          #else
    874            retValue = ZMacUnsupported;
    875          #endif
    876          
    877            /* Build and send back the response */
    878            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_UTIL), cmdId, 1, &retValue );
    879          }
    880          
    881          /***************************************************************************************************
    882           * @fn          MT_UtilSrcMatchDeleteEntry
    883           *
    884           * @brief      Delete a short or extended address from source address table.
    885           *
    886           * @param      pBuf - Buffer contains the data
    887           *
    888           * @return     void
    889           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    890          void MT_UtilSrcMatchDeleteEntry (uint8 *pBuf)
   \                     MT_UtilSrcMatchDeleteEntry:
   \   000000   80..         SJMP    ?Subroutine3
    891          {
    892            uint8 retValue, cmdId;
    893          
    894            /* Parse header */
    895            cmdId = pBuf[MT_RPC_POS_CMD1];
    896            pBuf += MT_RPC_FRAME_HDR_SZ;
    897          
    898          #ifdef AUTO_PEND
    899            uint16 panID;
    900            zAddrType_t devAddr;
    901          
    902            /* Address mode */
    903            devAddr.addrMode = *pBuf++;
    904          
    905            /* Address based on the address mode */
    906            MT_UtilSpi2Addr( &devAddr, pBuf);
    907            pBuf += Z_EXTADDR_LEN;
    908          
    909            /* PanID */
    910            panID = BUILD_UINT16( pBuf[0] , pBuf[1] );
    911          
    912            /* Call the routine */
    913            retValue =  ZMacSrcMatchDeleteEntry (&devAddr, panID);
    914          #else
    915            retValue = ZMacUnsupported;
    916          #endif
    917          
    918            /* Build and send back the response */
    919            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_UTIL), cmdId, 1, &retValue );
    920          }
    921          
    922          /***************************************************************************************************
    923           * @fn          MT_UtilSrcMatchCheckSrcAddr
    924           *
    925           * @brief      Check if a short or extended address is in the source address table.
    926           *
    927           * @param      pBuf - Buffer contains the data
    928           *
    929           * @return     void
    930           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    931          void MT_UtilSrcMatchCheckSrcAddr (uint8 *pBuf)
   \                     MT_UtilSrcMatchCheckSrcAddr:
    932          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 2
   \   000004   74FE         MOV     A,#-0x2
   \   000006   12....       LCALL   ?ALLOC_XSTACK8
    933            uint8 cmdId;
    934            uint8 retArray[2];
    935          
    936            /* Parse header */
    937            cmdId = pBuf[MT_RPC_POS_CMD1];
   \   000009   12....       LCALL   ?Subroutine15 & 0xFFFF
    938            pBuf += MT_RPC_FRAME_HDR_SZ;
    939          
    940          #if 0  /* Unsupported  */
    941            uint16 panID;
    942            zAddrType_t devAddr;
    943          
    944            /* Address mode */
    945            devAddr.addrMode = *pBuf++;
    946          
    947            /* Address based on the address mode */
    948            MT_UtilSpi2Addr( &devAddr, pBuf);
    949            pBuf += Z_EXTADDR_LEN;
    950          
    951            /* PanID */
    952            panID = BUILD_UINT16( pBuf[0] , pBuf[1] );
    953          
    954            /* Call the routine */
    955            retArray[1] =  ZMacSrcMatchCheckSrcAddr (&devAddr, panID);
    956          
    957              /* Return failure if the index is invalid */
    958            if (retArray[1] == ZMacSrcMatchInvalidIndex )
    959            {
    960              retArray[0] = ZFailure;
    961            }
    962            else
    963            {
    964              retArray[0] = ZSuccess;
    965            }
    966          #else
    967            retArray[0] = ZMacUnsupported;
    968            retArray[1] = ZMacSrcMatchInvalidIndex;
   \                     ??CrossCallReturnLabel_19:
   \   00000C   12....       LCALL   ?XSTACK_DISP0_8
   \   00000F   74FF         MOV     A,#-0x1
   \   000011                REQUIRE ?Subroutine4
   \   000011                ; // Fall through to label ?Subroutine4
    969          #endif
    970          
    971            /* Build and send back the response */
    972            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_UTIL), cmdId, 2, retArray );
    973          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine4:
   \   000000   12....       LCALL   ?Subroutine21 & 0xFFFF
   \                     ??CrossCallReturnLabel_27:
   \   000003   7967         MOV     R1,#0x67
   \   000005   12....       LCALL   ??MT_BuildAndSendZToolResponse?relay
   \   000008   7402         MOV     A,#0x2
   \   00000A   80..         SJMP    ??Subroutine43_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine15:
   \   000000   12....       LCALL   ?Subroutine30 & 0xFFFF
   \                     ??CrossCallReturnLabel_43:
   \   000003   F0           MOVX    @DPTR,A
   \   000004   7401         MOV     A,#0x1
   \   000006   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine21:
   \   000000   12....       LCALL   ?Subroutine32 & 0xFFFF
   \                     ??CrossCallReturnLabel_47:
   \   000003   7B02         MOV     R3,#0x2
   \   000005   22           RET
    974          
    975          /***************************************************************************************************
    976           * @fn          MT_UtilSrcMatchAckAllPending
    977           *
    978           * @brief       Enabled/disable acknowledging all packets with pending bit set
    979           *              It is normally enabled when adding new entries to
    980           *              the source address table fails due to the table is full, or
    981           *              disabled when more entries are deleted and the table has
    982           *              empty slots.
    983           *
    984           * @param       pBuf - Buffer contains the data
    985           *
    986           * @return      void
    987           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    988          void MT_UtilSrcMatchAckAllPending (uint8 *pBuf)
   \                     MT_UtilSrcMatchAckAllPending:
   \   000000                REQUIRE ?Subroutine3
   \   000000                ; // Fall through to label ?Subroutine3
    989          {
    990            uint8 retValue, cmdId;
    991          
    992            /* Parse header */
    993            cmdId = pBuf[MT_RPC_POS_CMD1];
    994            pBuf += MT_RPC_FRAME_HDR_SZ;
    995          
    996          #ifdef AUTO_PEND
    997            /* Call the routine */
    998            retValue = ZMacSrcMatchAckAllPending(*pBuf);
    999          #else
   1000            retValue = ZMacUnsupported;
   1001          #endif
   1002          
   1003            /* Build and send back the response */
   1004            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_UTIL), cmdId, 1, &retValue );
   1005          }
   1006          
   1007          /***************************************************************************************************
   1008           * @fn          MT_UtilSrcMatchCheckAllPending
   1009           *
   1010           * @brief       Check if acknowledging all packets with pending bit set
   1011           *              is enabled.
   1012           *
   1013           * @param       pBuf - Buffer contains the data
   1014           *
   1015           * @return      void
   1016           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1017          void MT_UtilSrcMatchCheckAllPending (uint8 *pBuf)
   \                     MT_UtilSrcMatchCheckAllPending:
   1018          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 2
   \   000004   74FE         MOV     A,#-0x2
   \   000006   12....       LCALL   ?ALLOC_XSTACK8
   1019            uint8 retArray[2], cmdId;
   1020          
   1021            /* Parse header */
   1022            cmdId = pBuf[MT_RPC_POS_CMD1];
   \   000009   12....       LCALL   ?Subroutine15 & 0xFFFF
   1023            pBuf += MT_RPC_FRAME_HDR_SZ;
   1024          
   1025          #ifdef AUTO_PEND
   1026            /* Call the routine */
   1027            retArray[0] = ZMacSuccess;
   1028            retArray[1] = ZMacSrcMatchCheckAllPending();
   1029          #else
   1030            retArray[0] = ZMacUnsupported;
   1031            retArray[1] = FALSE;
   \                     ??CrossCallReturnLabel_20:
   \   00000C   12....       LCALL   ?XSTACK_DISP0_8
   \   00000F   E4           CLR     A
   \   000010   80..         SJMP    ?Subroutine4
   1032          #endif
   1033          
   1034            /* Build and send back the response */
   1035            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_UTIL), cmdId, 2, retArray );
   1036          }
   1037          
   1038          /***************************************************************************************************
   1039           * SUPPORT
   1040           ***************************************************************************************************/
   1041          
   1042          #ifdef AUTO_PEND
   1043          /***************************************************************************************************
   1044           * @fn      MT_UtilRevExtCpy
   1045           *
   1046           * @brief
   1047           *
   1048           *   Reverse-copy an extended address.
   1049           *
   1050           * @param   pDst - Pointer to data destination
   1051           * @param   pSrc - Pointer to data source
   1052           *
   1053           * @return  void
   1054           ***************************************************************************************************/
   1055          static void MT_UtilRevExtCpy( uint8 *pDst, uint8 *pSrc )
   1056          {
   1057            int8 i;
   1058          
   1059            for ( i = Z_EXTADDR_LEN - 1; i >= 0; i-- )
   1060            {
   1061              *pDst++ = pSrc[i];
   1062            }
   1063          }
   1064          
   1065          /***************************************************************************************************
   1066           * @fn      MT_UtilSpi2Addr
   1067           *
   1068           * @brief   Copy an address from an SPI message to an address struct.  The
   1069           *          addrMode in pAddr must already be set.
   1070           *
   1071           * @param   pDst - Pointer to address struct
   1072           * @param   pSrc - Pointer SPI message byte array
   1073           *
   1074           * @return  void
   1075           ***************************************************************************************************/
   1076          static void MT_UtilSpi2Addr( zAddrType_t *pDst, uint8 *pSrc )
   1077          {
   1078            if ( pDst->addrMode == Addr16Bit )
   1079            {
   1080              pDst->addr.shortAddr = BUILD_UINT16( pSrc[0] , pSrc[1] );
   1081            }
   1082            else if ( pDst->addrMode == Addr64Bit )
   1083            {
   1084              MT_UtilRevExtCpy( pDst->addr.extAddr, pSrc );
   1085            }
   1086          }
   1087          #endif // AUTO_PEND
   1088          
   1089          #if !defined NONWK
   1090          /**************************************************************************************************
   1091           * @fn      MT_UtilDataReq
   1092           *
   1093           * @brief   Process the MAC Data Request command.
   1094           *
   1095           * @param   pBuf - pointer to the received data
   1096           *
   1097           * @return  None
   1098          **************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1099          void MT_UtilDataReq(uint8 *pBuf)
   \                     MT_UtilDataReq:
   1100          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 1
   \   000004   74FF         MOV     A,#-0x1
   \   000006   12....       LCALL   ?ALLOC_XSTACK8
   1101            uint8 rtrn = NwkPollReq(pBuf[MT_RPC_POS_DAT0]);
   \   000009                ; Setup parameters for call to function NwkPollReq
   \   000009   8A82         MOV     DPL,R2
   \   00000B   8B83         MOV     DPH,R3
   \   00000D   A3           INC     DPTR
   \   00000E   A3           INC     DPTR
   \   00000F   A3           INC     DPTR
   \   000010   E0           MOVX    A,@DPTR
   \   000011   F9           MOV     R1,A
   \   000012   12....       LCALL   ??NwkPollReq?relay
   \   000015   12....       LCALL   ?Subroutine20 & 0xFFFF
   1102            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_UTIL), MT_UTIL_DATA_REQ,
   1103                                                                                         1, &rtrn);
   \                     ??CrossCallReturnLabel_60:
   \   000018   7A11         MOV     R2,#0x11
   \   00001A   80..         SJMP    ??Subroutine42_0
   1104          }
   1105          
   1106          /***************************************************************************************************
   1107           * @fn      MT_UtilAddrMgrEntryLookupExt
   1108           *
   1109           * @brief   Proxy the AddrMgrEntryLookupExt() function.
   1110           *
   1111           * @param   pBuf - pointer to the received buffer
   1112           *
   1113           * @return  void
   1114           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1115          static void MT_UtilAddrMgrEntryLookupExt(uint8 *pBuf)
   \                     MT_UtilAddrMgrEntryLookupExt:
   1116          {
   \   000000   74F5         MOV     A,#-0xb
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 11
   \   000005                ; Auto size: 15
   \   000005   74F1         MOV     A,#-0xf
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   1117            uint8 nwkAddr[2];
   1118            AddrMgrEntry_t entry;
   1119            uint8 cmdId = pBuf[MT_RPC_POS_CMD1];
   \   00000A   12....       LCALL   ?Subroutine14 & 0xFFFF
   1120            pBuf += MT_RPC_FRAME_HDR_SZ;
   1121          
   1122            osal_memcpy(entry.extAddr, pBuf, Z_EXTADDR_LEN);
   \                     ??CrossCallReturnLabel_18:
   \   00000D   89..         MOV     ?V0 + 0,R1
   \   00000F   8A..         MOV     ?V0 + 1,R2
   \   000011   75..00       MOV     ?V0 + 2,#0x0
   \   000014   78..         MOV     R0,#?V0 + 0
   \   000016   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   000019   7C08         MOV     R4,#0x8
   \   00001B   7D00         MOV     R5,#0x0
   \   00001D   EC           MOV     A,R4
   \   00001E   12....       LCALL   ?XSTACK_DISP0_8
   \   000021   AA82         MOV     R2,DPL
   \   000023   AB83         MOV     R3,DPH
   \   000025   12....       LCALL   ??osal_memcpy?relay
   \   000028   7403         MOV     A,#0x3
   \   00002A   12....       LCALL   ?DEALLOC_XSTACK8
   1123            (void)AddrMgrEntryLookupExt(&entry);
   \   00002D                ; Setup parameters for call to function AddrMgrEntryLookupExt
   \   00002D   7402         MOV     A,#0x2
   \   00002F   12....       LCALL   ?XSTACK_DISP0_8
   \   000032   AA82         MOV     R2,DPL
   \   000034   AB83         MOV     R3,DPH
   \   000036   12....       LCALL   ??AddrMgrEntryLookupExt?relay
   1124            
   1125            nwkAddr[0] = LO_UINT16(entry.nwkAddr);
   \   000039   7403         MOV     A,#0x3
   \   00003B   12....       LCALL   ?XSTACK_DISP0_8
   \   00003E   E0           MOVX    A,@DPTR
   \   00003F   85..82       MOV     DPL,?XSP + 0
   \   000042   85..83       MOV     DPH,?XSP + 1
   \   000045   F0           MOVX    @DPTR,A
   1126            nwkAddr[1] = HI_UINT16(entry.nwkAddr);
   \   000046   7403         MOV     A,#0x3
   \   000048   12....       LCALL   ?XSTACK_DISP0_8
   \   00004B   A3           INC     DPTR
   \   00004C   E0           MOVX    A,@DPTR
   \   00004D   C0E0         PUSH    A
   \   00004F   7401         MOV     A,#0x1
   \   000051   12....       LCALL   ?XSTACK_DISP0_8
   \   000054   D0E0         POP     A
   \   000056   12....       LCALL   ?Subroutine21 & 0xFFFF
   1127            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_UTIL),
   1128                                                 cmdId, sizeof(uint16), nwkAddr);
   \                     ??CrossCallReturnLabel_28:
   \   000059   EE           MOV     A,R6
   \   00005A   FA           MOV     R2,A
   \   00005B   7967         MOV     R1,#0x67
   \   00005D   12....       LCALL   ??MT_BuildAndSendZToolResponse?relay
   1129          }
   \   000060   740F         MOV     A,#0xf
   \   000062   12....       LCALL   ?DEALLOC_XSTACK8
   \   000065   7F03         MOV     R7,#0x3
   \   000067   02....       LJMP    ?BANKED_LEAVE_XDATA

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine14:
   \   000000   12....       LCALL   ?Subroutine31 & 0xFFFF
   \                     ??CrossCallReturnLabel_44:
   \   000003   A982         MOV     R1,DPL
   \   000005   AA83         MOV     R2,DPH
   \   000007   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine31:
   \   000000   8A82         MOV     DPL,R2
   \   000002   8B83         MOV     DPH,R3
   \   000004   A3           INC     DPTR
   \   000005   A3           INC     DPTR
   \   000006   E0           MOVX    A,@DPTR
   \   000007   FE           MOV     R6,A
   \   000008                ; Setup parameters for call to function osal_memcpy
   \   000008                ; Setup parameters for call to function osal_memcpy
   \   000008                ; Setup parameters for call to function packDev_t
   \   000008                ; Setup parameters for call to function AssocFindDevice
   \   000008   8A82         MOV     DPL,R2
   \   00000A   8B83         MOV     DPH,R3
   \   00000C   A3           INC     DPTR
   \   00000D   A3           INC     DPTR
   \   00000E   A3           INC     DPTR
   \   00000F   22           RET
   1130          
   1131          /***************************************************************************************************
   1132           * @fn      MT_UtilAddrMgrEntryLookupNwk
   1133           *
   1134           * @brief   Proxy the AddrMgrEntryLookupNwk() function.
   1135           *
   1136           * @param   pBuf - pointer to the received buffer
   1137           *
   1138           * @return  void
   1139           ***************************************************************************************************/
   1140          static void MT_UtilAddrMgrEntryLookupNwk(uint8 *pBuf)
   1141          {
   1142            AddrMgrEntry_t entry;
   1143            uint8 cmdId = pBuf[MT_RPC_POS_CMD1];
   1144            pBuf += MT_RPC_FRAME_HDR_SZ;
   1145          
   1146            entry.nwkAddr = BUILD_UINT16(pBuf[0], pBuf[1]);
   1147            (void)AddrMgrEntryLookupNwk(&entry);
   1148          
   1149            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_UTIL),
   1150                                                 cmdId, Z_EXTADDR_LEN, entry.extAddr);
   1151          }
   1152          
   1153          #if defined MT_SYS_KEY_MANAGEMENT
   1154          /***************************************************************************************************
   1155           * @fn      MT_UtilAPSME_LinkKeyDataGet
   1156           *
   1157           * @brief   Retrieves APS Link Key data from NV.
   1158           *
   1159           * @param   pBuf - pointer to the received buffer
   1160           *
   1161           * @return  void
   1162           ***************************************************************************************************/
   1163          static void MT_UtilAPSME_LinkKeyDataGet(uint8 *pBuf)
   1164          {
   1165            uint8 rsp[MT_APSME_LINKKEY_GET_RSP_LEN];
   1166            APSME_LinkKeyData_t *pData = NULL;
   1167            uint8 cmdId = pBuf[MT_RPC_POS_CMD1];
   1168            uint16 apsLinkKeyNvId;
   1169            uint32 *apsRxFrmCntr;
   1170            uint32 *apsTxFrmCntr;
   1171          
   1172            pBuf += MT_RPC_FRAME_HDR_SZ;
   1173          
   1174            *rsp = APSME_LinkKeyNVIdGet(pBuf, &apsLinkKeyNvId);
   1175          
   1176            if (SUCCESS == *rsp)
   1177            {
   1178              pData = (APSME_LinkKeyData_t *)osal_mem_alloc(sizeof(APSME_LinkKeyData_t));
   1179          
   1180              if (pData != NULL)
   1181              {
   1182                // retrieve key from NV
   1183                if ( osal_nv_read( apsLinkKeyNvId, 0,
   1184                                  sizeof(APSME_LinkKeyData_t), pData) == SUCCESS)
   1185          
   1186                {
   1187                  apsRxFrmCntr = &ApsLinkKeyFrmCntr[apsLinkKeyNvId - ZCD_NV_APS_LINK_KEY_DATA_START].rxFrmCntr;
   1188                  apsTxFrmCntr = &ApsLinkKeyFrmCntr[apsLinkKeyNvId - ZCD_NV_APS_LINK_KEY_DATA_START].txFrmCntr;
   1189          
   1190                  uint8 *ptr = rsp+1;
   1191                  (void)osal_memcpy(ptr, pData->key, SEC_KEY_LEN);
   1192                  ptr += SEC_KEY_LEN;
   1193                  *ptr++ = BREAK_UINT32(*apsTxFrmCntr, 0);
   1194                  *ptr++ = BREAK_UINT32(*apsTxFrmCntr, 1);
   1195                  *ptr++ = BREAK_UINT32(*apsTxFrmCntr, 2);
   1196                  *ptr++ = BREAK_UINT32(*apsTxFrmCntr, 3);
   1197                  *ptr++ = BREAK_UINT32(*apsRxFrmCntr, 0);
   1198                  *ptr++ = BREAK_UINT32(*apsRxFrmCntr, 1);
   1199                  *ptr++ = BREAK_UINT32(*apsRxFrmCntr, 2);
   1200                  *ptr++ = BREAK_UINT32(*apsRxFrmCntr, 3);
   1201                }
   1202          
   1203                // clear copy of key in RAM
   1204                osal_memset( pData, 0x00, sizeof(APSME_LinkKeyData_t) );
   1205          
   1206                osal_mem_free(pData);
   1207              }
   1208            }
   1209            else
   1210            {
   1211              // set data key and counters 0xFF
   1212              osal_memset(&rsp[1], 0xFF, SEC_KEY_LEN + (MT_UTIL_FRM_CTR_LEN * 2));
   1213            }
   1214          
   1215            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_UTIL), cmdId,
   1216                                                 MT_APSME_LINKKEY_GET_RSP_LEN, rsp);
   1217          
   1218            // clear key data
   1219            osal_memset(rsp, 0x00, MT_APSME_LINKKEY_GET_RSP_LEN);
   1220          
   1221          }
   1222          
   1223          /***************************************************************************************************
   1224           * @fn      MT_UtilAPSME_LinkKeyNvIdGet
   1225           *
   1226           * @brief   Retrieves APS Link Key NV ID from the entry table.
   1227           *
   1228           * @param   pBuf - pointer to the received buffer
   1229           *
   1230           * @return  void
   1231           ***************************************************************************************************/
   1232          static void MT_UtilAPSME_LinkKeyNvIdGet(uint8 *pBuf)
   1233          {
   1234            uint8 rsp[MT_APSME_LINKKEY_NV_ID_GET_RSP_LEN];
   1235            uint8 cmdId = pBuf[MT_RPC_POS_CMD1];
   1236            uint16 apsLinkKeyNvId;
   1237          
   1238            pBuf += MT_RPC_FRAME_HDR_SZ;
   1239          
   1240            *rsp = APSME_LinkKeyNVIdGet(pBuf, &apsLinkKeyNvId);
   1241          
   1242            if (SUCCESS == *rsp)
   1243            {
   1244              rsp[1] = LO_UINT16(apsLinkKeyNvId);
   1245              rsp[2] = HI_UINT16(apsLinkKeyNvId);
   1246            }
   1247            else
   1248            {
   1249              // send failure response with invalid NV ID
   1250              osal_memset(&rsp[1], 0xFF, 2);
   1251            }
   1252          
   1253            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_UTIL), cmdId,
   1254                                                 MT_APSME_LINKKEY_NV_ID_GET_RSP_LEN, rsp);
   1255          }
   1256          #endif // MT_SYS_KEY_MANAGEMENT
   1257          
   1258          /***************************************************************************************************
   1259           * @fn      MT_UtilAPSME_RequestKeyCmd
   1260           *
   1261           * @brief   Send RequestKey command message to TC for a specific partner Address.
   1262           *
   1263           * @param   pBuf  - pointer to the received buffer
   1264           *
   1265           * @return  void
   1266           ***************************************************************************************************/
   1267          void MT_UtilAPSME_RequestKeyCmd(uint8 *pBuf)
   1268          {
   1269            uint8 cmdId;
   1270            uint8 partnerAddr[Z_EXTADDR_LEN];
   1271            uint8 retValue;
   1272          
   1273            // parse header
   1274            cmdId = pBuf[MT_RPC_POS_CMD1];
   1275            pBuf += MT_RPC_FRAME_HDR_SZ;
   1276          
   1277            /* PartnerAddress */
   1278            osal_memcpy(partnerAddr, pBuf, Z_EXTADDR_LEN);
   1279          
   1280            retValue = (uint8)ZDSecMgrRequestAppKey(partnerAddr);
   1281          
   1282            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_UTIL), cmdId, 1, &retValue);
   1283          }
   1284          
   1285          /***************************************************************************************************
   1286           * @fn      MT_UtilAssocCount
   1287           *
   1288           * @brief   Proxy the AssocCount() function.
   1289           *
   1290           * @param   pBuf - pointer to the received buffer
   1291           *
   1292           * @return  void
   1293           ***************************************************************************************************/
   1294          static void MT_UtilAssocCount(uint8 *pBuf)
   1295          {
   1296            uint16 cnt;
   1297            uint8 cmdId = pBuf[MT_RPC_POS_CMD1];
   1298            pBuf += MT_RPC_FRAME_HDR_SZ;
   1299          
   1300            cnt = AssocCount(pBuf[0], pBuf[1]);
   1301            pBuf[0] = LO_UINT16(cnt);
   1302            pBuf[1] = HI_UINT16(cnt);
   1303          
   1304            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_UTIL), cmdId, 2, pBuf);
   1305          }
   1306          
   1307          /***************************************************************************************************
   1308           * @fn      MT_UtilAssocFindDevice
   1309           *
   1310           * @brief   Get an associated device by index.
   1311           *
   1312           * @param   pBuf - pointer to the received buffer
   1313           *
   1314           * @return  void
   1315           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1316          static void MT_UtilAssocFindDevice(uint8 *pBuf)
   \                     MT_UtilAssocFindDevice:
   1317          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 18
   \   000005   74EE         MOV     A,#-0x12
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   1318            uint8 cmdId = pBuf[MT_RPC_POS_CMD1];
   \   00000A   12....       LCALL   ?Subroutine31 & 0xFFFF
   1319            uint8 buf[sizeof(associated_devices_t)];
   1320          
   1321            packDev_t(buf, AssocFindDevice(pBuf[MT_RPC_FRAME_HDR_SZ]));
   \                     ??CrossCallReturnLabel_45:
   \   00000D   E0           MOVX    A,@DPTR
   \   00000E   F9           MOV     R1,A
   \   00000F   12....       LCALL   ??AssocFindDevice?relay
   \   000012   12....       LCALL   ?Subroutine26 & 0xFFFF
   1322            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_UTIL), cmdId,
   1323                                                 sizeof(associated_devices_t), buf);
   \                     ??CrossCallReturnLabel_36:
   \   000015   EE           MOV     A,R6
   \   000016   FA           MOV     R2,A
   \   000017                REQUIRE ?Subroutine5
   \   000017                ; // Fall through to label ?Subroutine5
   1324          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine5:
   \   000000   7967         MOV     R1,#0x67
   \   000002   12....       LCALL   ??MT_BuildAndSendZToolResponse?relay
   \   000005   7412         MOV     A,#0x12
   \   000007   02....       LJMP    ??Subroutine41_0 & 0xFFFF

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine26:
   \   000000   EA           MOV     A,R2
   \   000001   FC           MOV     R4,A
   \   000002   EB           MOV     A,R3
   \   000003   FD           MOV     R5,A
   \   000004   85..82       MOV     DPL,?XSP + 0
   \   000007   85..83       MOV     DPH,?XSP + 1
   \   00000A   AA82         MOV     R2,DPL
   \   00000C   AB83         MOV     R3,DPH
   \   00000E   12....       LCALL   ??packDev_t?relay
   \   000011                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   000011                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   000011   85..82       MOV     DPL,?XSP + 0
   \   000014   85..83       MOV     DPH,?XSP + 1
   \   000017   AC82         MOV     R4,DPL
   \   000019   AD83         MOV     R5,DPH
   \   00001B   7B12         MOV     R3,#0x12
   \   00001D   22           RET
   1325          
   1326          /***************************************************************************************************
   1327           * @fn      MT_UtilAssocGetWithAddress
   1328           *
   1329           * @brief   Get an associated device by address.
   1330           *
   1331           * @param   pBuf - pointer to the received buffer
   1332           *
   1333           * @return  void
   1334           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1335          static void MT_UtilAssocGetWithAddress(uint8 *pBuf)
   \                     MT_UtilAssocGetWithAddress:
   1336          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 18
   \   000005   74EE         MOV     A,#-0x12
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   EA           MOV     A,R2
   \   00000B   FE           MOV     R6,A
   \   00000C   EB           MOV     A,R3
   \   00000D   FF           MOV     R7,A
   1337            extern associated_devices_t *AssocGetWithAddress(uint8 *extAddr, uint16 shortAddr);
   1338            uint8 cmdId = pBuf[MT_RPC_POS_CMD1];
   \   00000E   12....       LCALL   ?Subroutine16 & 0xFFFF
   1339            uint8 buf[sizeof(associated_devices_t)];
   1340          
   1341            pBuf += MT_RPC_FRAME_HDR_SZ;
   1342            packDev_t(buf, AssocGetWithAddress(((AddrMgrExtAddrValid(pBuf)) ? pBuf : NULL),
   1343                                            BUILD_UINT16(pBuf[Z_EXTADDR_LEN], pBuf[Z_EXTADDR_LEN+1])));
   \                     ??CrossCallReturnLabel_22:
   \   000011                ; Setup parameters for call to function AddrMgrExtAddrValid
   \   000011   0A           INC     R2
   \   000012   0A           INC     R2
   \   000013   0A           INC     R2
   \   000014   FB           MOV     R3,A
   \   000015   12....       LCALL   ??AddrMgrExtAddrValid?relay
   \   000018   E9           MOV     A,R1
   \   000019   6006         JZ      ??MT_UtilAssocGetWithAddress_0
   \   00001B   EE           MOV     A,R6
   \   00001C   FA           MOV     R2,A
   \   00001D   EF           MOV     A,R7
   \   00001E   FB           MOV     R3,A
   \   00001F   8004         SJMP    ??MT_UtilAssocGetWithAddress_1
   \                     ??MT_UtilAssocGetWithAddress_0:
   \   000021   7A00         MOV     R2,#0x0
   \   000023   7B00         MOV     R3,#0x0
   \                     ??MT_UtilAssocGetWithAddress_1:
   \   000025                ; Setup parameters for call to function packDev_t
   \   000025                ; Setup parameters for call to function AssocGetWithAddress
   \   000025   8E82         MOV     DPL,R6
   \   000027   8F83         MOV     DPH,R7
   \   000029   A3           INC     DPTR
   \   00002A   A3           INC     DPTR
   \   00002B   A3           INC     DPTR
   \   00002C   A3           INC     DPTR
   \   00002D   A3           INC     DPTR
   \   00002E   A3           INC     DPTR
   \   00002F   A3           INC     DPTR
   \   000030   A3           INC     DPTR
   \   000031   E0           MOVX    A,@DPTR
   \   000032   FC           MOV     R4,A
   \   000033   8E82         MOV     DPL,R6
   \   000035   8F83         MOV     DPH,R7
   \   000037   A3           INC     DPTR
   \   000038   A3           INC     DPTR
   \   000039   A3           INC     DPTR
   \   00003A   A3           INC     DPTR
   \   00003B   A3           INC     DPTR
   \   00003C   A3           INC     DPTR
   \   00003D   A3           INC     DPTR
   \   00003E   A3           INC     DPTR
   \   00003F   A3           INC     DPTR
   \   000040   E0           MOVX    A,@DPTR
   \   000041   F9           MOV     R1,A
   \   000042   EC           MOV     A,R4
   \   000043   2400         ADD     A,#0x0
   \   000045   E4           CLR     A
   \   000046   39           ADDC    A,R1
   \   000047   FD           MOV     R5,A
   \   000048   12....       LCALL   ??AssocGetWithAddress?relay
   \   00004B   12....       LCALL   ?Subroutine26 & 0xFFFF
   1344          
   1345            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_UTIL), cmdId,
   1346                                                 sizeof(associated_devices_t), buf);
   \                     ??CrossCallReturnLabel_37:
   \   00004E   AA..         MOV     R2,?V0 + 0
   \   000050   80..         SJMP    ?Subroutine5
   1347          }
   1348          
   1349          /***************************************************************************************************
   1350           * @fn      packDev_t
   1351           *
   1352           * @brief   Pack an associated_devices_t structure into a byte buffer (pack INVALID_NODE_ADDR if
   1353           *          the pDev parameter is NULL).
   1354           *
   1355           * @param   pBuf - pointer to the buffer into which to pack the structure.
   1356           * @param   pDev - pointer to the structure.
   1357           *
   1358           * @return  void
   1359           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1360          static void packDev_t(uint8 *pBuf, associated_devices_t *pDev)
   \                     packDev_t:
   1361          {
   \   000000   74F4         MOV     A,#-0xc
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 12
   \   000005                ; Auto size: 0
   1362            if (NULL == pDev)
   \   000005   EC           MOV     A,R4
   \   000006   4D           ORL     A,R5
   \   000007   700C         JNZ     ??packDev_t_0
   1363            {
   1364              uint16 rtrn = INVALID_NODE_ADDR;
   1365              *pBuf++ = LO_UINT16(rtrn);
   \   000009   8A82         MOV     DPL,R2
   \   00000B   8B83         MOV     DPH,R3
   \   00000D   74FE         MOV     A,#-0x2
   \   00000F   F0           MOVX    @DPTR,A
   \   000010   A3           INC     DPTR
   1366              *pBuf++ = HI_UINT16(rtrn);
   \   000011   04           INC     A
   \   000012   02....       LJMP    ??CrossCallReturnLabel_12 & 0xFFFF
   1367            }
   1368            else
   1369            {
   1370              *pBuf++ = LO_UINT16(pDev->shortAddr);
   \                     ??packDev_t_0:
   \   000015   8C82         MOV     DPL,R4
   \   000017   8D83         MOV     DPH,R5
   \   000019   E0           MOVX    A,@DPTR
   \   00001A   8A82         MOV     DPL,R2
   \   00001C   8B83         MOV     DPH,R3
   \   00001E   F0           MOVX    @DPTR,A
   \   00001F   A3           INC     DPTR
   \   000020   AA82         MOV     R2,DPL
   \   000022   AB83         MOV     R3,DPH
   1371              *pBuf++ = HI_UINT16(pDev->shortAddr);
   \   000024   8C82         MOV     DPL,R4
   \   000026   8D83         MOV     DPH,R5
   \   000028   12....       LCALL   ?Subroutine11 & 0xFFFF
   1372              *pBuf++ = LO_UINT16(pDev->addrIdx);
   \                     ??CrossCallReturnLabel_65:
   \   00002B   2402         ADD     A,#0x2
   \   00002D   12....       LCALL   ?Subroutine10 & 0xFFFF
   1373              *pBuf++ = HI_UINT16(pDev->addrIdx);
   \                     ??CrossCallReturnLabel_11:
   \   000030   12....       LCALL   ?Subroutine36 & 0xFFFF
   1374              *pBuf++ = pDev->nodeRelation;
   \                     ??CrossCallReturnLabel_73:
   \   000033   8C82         MOV     DPL,R4
   \   000035   8D83         MOV     DPH,R5
   \   000037   A3           INC     DPTR
   \   000038   A3           INC     DPTR
   \   000039   A3           INC     DPTR
   \   00003A   A3           INC     DPTR
   \   00003B   12....       LCALL   ?Subroutine12 & 0xFFFF
   1375              *pBuf++ = pDev->devStatus;
   \                     ??CrossCallReturnLabel_13:
   \   00003E   12....       LCALL   ?Subroutine12 & 0xFFFF
   1376              *pBuf++ = pDev->assocCnt;
   \                     ??CrossCallReturnLabel_14:
   \   000041   A3           INC     DPTR
   \   000042   12....       LCALL   ?Subroutine9 & 0xFFFF
   1377              *pBuf++ = pDev->age;
   \                     ??CrossCallReturnLabel_9:
   \   000045   12....       LCALL   ?Subroutine9 & 0xFFFF
   1378              *pBuf++ = pDev->linkInfo.txCounter;
   \                     ??CrossCallReturnLabel_10:
   \   000048   A3           INC     DPTR
   \   000049   12....       LCALL   ?Subroutine8 & 0xFFFF
   1379              *pBuf++ = pDev->linkInfo.txCost;
   \                     ??CrossCallReturnLabel_7:
   \   00004C   12....       LCALL   ?Subroutine8 & 0xFFFF
   1380              *pBuf++ = pDev->linkInfo.rxLqi;
   \                     ??CrossCallReturnLabel_8:
   \   00004F   12....       LCALL   ?Subroutine11 & 0xFFFF
   1381              *pBuf++ = pDev->linkInfo.inKeySeqNum;
   \                     ??CrossCallReturnLabel_66:
   \   000052   240B         ADD     A,#0xb
   \   000054   F582         MOV     DPL,A
   \   000056   ED           MOV     A,R5
   \   000057   3400         ADDC    A,#0x0
   \   000059   F583         MOV     DPH,A
   \   00005B   12....       LCALL   ??Subroutine45_0 & 0xFFFF
   1382              *pBuf++ = BREAK_UINT32(pDev->linkInfo.inFrmCntr, 0);
   \                     ??CrossCallReturnLabel_67:
   \   00005E   240C         ADD     A,#0xc
   \   000060   F8           MOV     R0,A
   \   000061   ED           MOV     A,R5
   \   000062   12....       LCALL   ?Subroutine17 & 0xFFFF
   \                     ??CrossCallReturnLabel_24:
   \   000065   78..         MOV     R0,#?V0 + 0
   \   000067   12....       LCALL   ?L_MOV_X
   \   00006A   12....       LCALL   ?Subroutine18 & 0xFFFF
   1383              *pBuf++ = BREAK_UINT32(pDev->linkInfo.inFrmCntr, 1);
   \                     ??CrossCallReturnLabel_62:
   \   00006D   12....       LCALL   ?L_MOV_X
   \   000070   E5..         MOV     A,?V0 + 1
   \   000072   8A82         MOV     DPL,R2
   \   000074   8B83         MOV     DPH,R3
   \   000076   12....       LCALL   ??Subroutine44_0 & 0xFFFF
   1384              *pBuf++ = BREAK_UINT32(pDev->linkInfo.inFrmCntr, 2);
   \                     ??CrossCallReturnLabel_64:
   \   000079   12....       LCALL   ?L_MOV_X
   \   00007C   7410         MOV     A,#0x10
   \   00007E   78..         MOV     R0,#?V0 + 0
   \   000080   12....       LCALL   ?UL_SHR
   \   000083   12....       LCALL   ?Subroutine18 & 0xFFFF
   1385              *pBuf++ = BREAK_UINT32(pDev->linkInfo.inFrmCntr, 3);
   \                     ??CrossCallReturnLabel_63:
   \   000086   12....       LCALL   ?L_MOV_X
   \   000089   7418         MOV     A,#0x18
   \   00008B   78..         MOV     R0,#?V0 + 0
   \   00008D   12....       LCALL   ?UL_SHR
   \   000090   8A82         MOV     DPL,R2
   \   000092   8B83         MOV     DPH,R3
   \   000094   E5..         MOV     A,?V0 + 0
   \   000096   12....       LCALL   ?Subroutine36 & 0xFFFF
   1386              *pBuf++ = LO_UINT16(pDev->linkInfo.txFailure);
   \                     ??CrossCallReturnLabel_74:
   \   000099   EC           MOV     A,R4
   \   00009A   2410         ADD     A,#0x10
   \   00009C   12....       LCALL   ?Subroutine10 & 0xFFFF
   1387              *pBuf++ = HI_UINT16(pDev->linkInfo.txFailure);
   1388            }
   \                     ??CrossCallReturnLabel_12:
   \   00009F   F0           MOVX    @DPTR,A
   1389          }
   \   0000A0   7F04         MOV     R7,#0x4
   \   0000A2   02....       LJMP    ?BANKED_LEAVE_XDATA

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine18:
   \   000000   8A82         MOV     DPL,R2
   \   000002   8B83         MOV     DPH,R3
   \   000004   E5..         MOV     A,?V0 + 0
   \   000006                REQUIRE ??Subroutine44_0
   \   000006                ; // Fall through to label ??Subroutine44_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine44_0:
   \   000000   12....       LCALL   ?Subroutine36 & 0xFFFF
   \                     ??CrossCallReturnLabel_75:
   \   000003   8E82         MOV     DPL,R6
   \   000005   8F83         MOV     DPH,R7
   \   000007   78..         MOV     R0,#?V0 + 0
   \   000009   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine17:
   \   000000   3400         ADDC    A,#0x0
   \   000002   F9           MOV     R1,A
   \   000003   E8           MOV     A,R0
   \   000004   FE           MOV     R6,A
   \   000005   E9           MOV     A,R1
   \   000006   FF           MOV     R7,A
   \   000007   8E82         MOV     DPL,R6
   \   000009   8F83         MOV     DPH,R7
   \   00000B   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine12:
   \   000000   12....       LCALL   ?Subroutine28 & 0xFFFF
   \                     ??CrossCallReturnLabel_69:
   \   000003   8C82         MOV     DPL,R4
   \   000005   8D83         MOV     DPH,R5
   \   000007   A3           INC     DPTR
   \   000008   A3           INC     DPTR
   \   000009   A3           INC     DPTR
   \   00000A   A3           INC     DPTR
   \   00000B   A3           INC     DPTR
   \   00000C   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine11:
   \   000000   A3           INC     DPTR
   \   000001                REQUIRE ??Subroutine45_0
   \   000001                ; // Fall through to label ??Subroutine45_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine45_0:
   \   000000   12....       LCALL   ?Subroutine28 & 0xFFFF
   \                     ??CrossCallReturnLabel_70:
   \   000003   EC           MOV     A,R4
   \   000004   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine28:
   \   000000   12....       LCALL   ?Subroutine35 & 0xFFFF
   \                     ??CrossCallReturnLabel_72:
   \   000003   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine35:
   \   000000   E0           MOVX    A,@DPTR
   \   000001   8A82         MOV     DPL,R2
   \   000003   8B83         MOV     DPH,R3
   \   000005   12....       LCALL   ?Subroutine36 & 0xFFFF
   \                     ??CrossCallReturnLabel_76:
   \   000008   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine36:
   \   000000   F0           MOVX    @DPTR,A
   \   000001   A3           INC     DPTR
   \   000002   0A           INC     R2
   \   000003   AB83         MOV     R3,DPH
   \   000005   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine10:
   \   000000   F8           MOV     R0,A
   \   000001   ED           MOV     A,R5
   \   000002   3400         ADDC    A,#0x0
   \   000004   F9           MOV     R1,A
   \   000005   8882         MOV     DPL,R0
   \   000007   8983         MOV     DPH,R1
   \   000009   12....       LCALL   ?Subroutine28 & 0xFFFF
   \                     ??CrossCallReturnLabel_68:
   \   00000C   8882         MOV     DPL,R0
   \   00000E   8983         MOV     DPH,R1
   \   000010   A3           INC     DPTR
   \   000011   E0           MOVX    A,@DPTR
   \   000012   8A82         MOV     DPL,R2
   \   000014   8B83         MOV     DPH,R3
   \   000016   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine9:
   \   000000   12....       LCALL   ?Subroutine27 & 0xFFFF
   \                     ??CrossCallReturnLabel_38:
   \   000003   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine27:
   \   000000   12....       LCALL   ?Subroutine35 & 0xFFFF
   \                     ??CrossCallReturnLabel_71:
   \   000003   8C82         MOV     DPL,R4
   \   000005   8D83         MOV     DPH,R5
   \   000007   A3           INC     DPTR
   \   000008   A3           INC     DPTR
   \   000009   A3           INC     DPTR
   \   00000A   A3           INC     DPTR
   \   00000B   A3           INC     DPTR
   \   00000C   A3           INC     DPTR
   \   00000D   A3           INC     DPTR
   \   00000E   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine8:
   \   000000   12....       LCALL   ?Subroutine27 & 0xFFFF
   \                     ??CrossCallReturnLabel_39:
   \   000003   A3           INC     DPTR
   \   000004   A3           INC     DPTR
   \   000005   22           RET

   \                                 In  segment XDATA_ROM_C, align 1
   \                     __Constant_ffffffff:
   \   000000   FFFFFFFF     DD 4294967295

   \                                 In  segment XDATA_ROM_C, align 1
   \                     __Constant_0:
   \   000000   00000000     DD 0

   \                                 In  segment XDATA_ROM_C, align 1
   \                     __Constant_3e8:
   \   000000   E8030000     DD 1000

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_UtilCommandProcessing?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_UtilCommandProcessing

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_UtilGetDeviceInfo?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_UtilGetDeviceInfo

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_UtilGetNvInfo?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_UtilGetNvInfo

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_UtilSetPanID?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_UtilSetPanID

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_UtilSetChannels?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_UtilSetChannels

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_UtilSetSecLevel?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_UtilSetSecLevel

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_UtilSetPreCfgKey?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_UtilSetPreCfgKey

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_UtilCallbackSub?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_UtilCallbackSub

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_UtilKeyEvent?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_UtilKeyEvent

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_UtilTimeAlive?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_UtilTimeAlive

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_UtilLedControl?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_UtilLedControl

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_UtilSrcMatchEnable?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_UtilSrcMatchEnable

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_UtilSrcMatchAddEntry?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_UtilSrcMatchAddEntry

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_UtilSrcMatchDeleteEntry?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_UtilSrcMatchDeleteEntry

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_UtilSrcMatchCheckSrcAddr?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_UtilSrcMatchCheckSrcAddr

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_UtilSrcMatchAckAllPending?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_UtilSrcMatchAckAllPending

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_UtilSrcMatchCheckAllPending?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_UtilSrcMatchCheckAllPending

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_UtilDataReq?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_UtilDataReq

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_UtilAddrMgrEntryLookupExt?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_UtilAddrMgrEntryLookupExt

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_UtilAssocFindDevice?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_UtilAssocFindDevice

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_UtilAssocGetWithAddress?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_UtilAssocGetWithAddress

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??packDev_t?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    packDev_t
   1390          
   1391          #if defined ZCL_KEY_ESTABLISH
   1392          /***************************************************************************************************
   1393           * @fn      MT_UtilzclGeneral_KeyEstablish_InitiateKeyEstablishment
   1394           *
   1395           * @brief   Proxy the zclGeneral_KeyEstablish_InitiateKeyEstablishment() function.
   1396           *
   1397           * @param   pBuf - pointer to the received buffer
   1398           *
   1399           * @return  void
   1400           ***************************************************************************************************/
   1401          static void MT_UtilzclGeneral_KeyEstablish_InitiateKeyEstablishment(uint8 *pBuf)
   1402          {
   1403            afAddrType_t partnerAddr;
   1404            uint8 cmdId = pBuf[MT_RPC_POS_CMD1];
   1405            pBuf += MT_RPC_FRAME_HDR_SZ;
   1406          
   1407            partnerAddr.panId = 0;  // Not an inter-pan message.
   1408            partnerAddr.endPoint = pBuf[2];
   1409            partnerAddr.addrMode = (afAddrMode_t)pBuf[3];
   1410            if (afAddr64Bit == partnerAddr.addrMode)
   1411            {
   1412              (void)osal_memcpy(partnerAddr.addr.extAddr, pBuf+4, Z_EXTADDR_LEN);
   1413            }
   1414            else
   1415            {
   1416              partnerAddr.addr.shortAddr = BUILD_UINT16(pBuf[4], pBuf[5]);
   1417            }
   1418          
   1419            zcl_key_establish_task_id = pBuf[0];
   1420            *pBuf = zclGeneral_KeyEstablish_InitiateKeyEstablishment(MT_TaskID, &partnerAddr, pBuf[1]);
   1421            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_UTIL), cmdId, 1, pBuf);
   1422          }
   1423          
   1424          /***************************************************************************************************
   1425           * @fn      MT_UtilzclGeneral_KeyEstablishment_ECDSASign
   1426           *
   1427           * @brief   Proxy the zclGeneral_KeyEstablishment_ECDSASign() function.
   1428           *
   1429           * @param   pBuf - pointer to the received buffer
   1430           *
   1431           * @return  void
   1432           ***************************************************************************************************/
   1433          static void MT_UtilzclGeneral_KeyEstablishment_ECDSASign(uint8 *pBuf)
   1434          {
   1435          #if defined TC_LINKKEY_JOIN
   1436            uint8 *output = osal_mem_alloc(SE_PROFILE_SIGNATURE_LENGTH+1);
   1437            uint8 cmdId = pBuf[MT_RPC_POS_CMD1];
   1438            pBuf += MT_RPC_FRAME_HDR_SZ;
   1439          
   1440            if (NULL == output)
   1441            {
   1442              *pBuf = FAILURE;
   1443              MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_UTIL), cmdId, 1, pBuf);
   1444            }
   1445            else
   1446            {
   1447              *output = zclGeneral_KeyEstablishment_ECDSASign(pBuf+1, *pBuf, output+1);
   1448              MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_UTIL), cmdId,
   1449                                                   SE_PROFILE_SIGNATURE_LENGTH+1, output);
   1450              osal_mem_free(output);
   1451            }
   1452          #endif
   1453          }
   1454          
   1455          /***************************************************************************************************
   1456           * @fn      MT_UtilKeyEstablishInd
   1457           *
   1458           * @brief   Proxy the ZCL_KEY_ESTABLISH_IND command.
   1459           *
   1460           * @param   pInd - Pointer to a keyEstablishmentInd_t structure.
   1461           *
   1462           * @return  None
   1463           ***************************************************************************************************/
   1464          void MT_UtilKeyEstablishInd(keyEstablishmentInd_t *pInd)
   1465          {
   1466            uint8 msg[6];
   1467          
   1468            msg[0] = zcl_key_establish_task_id;
   1469            msg[1] = pInd->hdr.event;
   1470            msg[2] = pInd->hdr.status;
   1471            msg[3] = pInd->waitTime;
   1472            msg[4] = LO_UINT16(pInd->keyEstablishmentSuite);
   1473            msg[5] = HI_UINT16(pInd->keyEstablishmentSuite);
   1474          
   1475            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_AREQ | (uint8)MT_RPC_SYS_UTIL),
   1476                                                 MT_UTIL_ZCL_KEY_ESTABLISH_IND, 6, msg);
   1477          }
   1478          #endif
   1479          
   1480          /***************************************************************************************************
   1481           * @fn      MT_UtilSync
   1482           *
   1483           * @brief   Process the MT_UTIL_SYNC command
   1484           *
   1485           * @param   None
   1486           *
   1487           * @return  None
   1488           ***************************************************************************************************/
   1489          static void MT_UtilSync(void)
   1490          {
   1491           MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_AREQ|(uint8)MT_RPC_SYS_UTIL),MT_UTIL_SYNC_REQ,0,0);
   1492          }
   1493          #endif /* !defined NONWK */
   1494          #endif /* MT_UTIL_FUNC */
   1495          /**************************************************************************************************
   1496           **************************************************************************************************/

   Maximum stack usage in bytes:

     Function                       ISTACK PSTACK XSTACK
     --------                       ------ ------ ------
     MT_UtilAddrMgrEntryLookupExt       1      0     66
       -> osal_memcpy                   0      0     58
       -> AddrMgrEntryLookupExt         0      0     52
       -> MT_BuildAndSendZToolResponse
                                        0      0     52
     MT_UtilAssocFindDevice             0      0     64
       -> AssocFindDevice               0      0     54
       -> packDev_t                     0      0     54
       -> MT_BuildAndSendZToolResponse
                                        0      0     54
     MT_UtilAssocGetWithAddress         0      0     64
       -> AddrMgrExtAddrValid           0      0     54
       -> AssocGetWithAddress           0      0     54
       -> packDev_t                     0      0     54
       -> MT_BuildAndSendZToolResponse
                                        0      0     54
     MT_UtilCallbackSub                 0      0     47
       -> MT_BuildAndSendZToolResponse
                                        0      0     20
     MT_UtilCommandProcessing           1      0     40
       -> MT_UtilGetDeviceInfo          0      0     74
       -> MT_UtilGetNvInfo              0      0     74
       -> MT_UtilSetPanID               0      0     74
       -> MT_UtilSetChannels            0      0     74
       -> MT_UtilSetSecLevel            0      0     74
       -> MT_UtilSetPreCfgKey           0      0     74
       -> MT_UtilCallbackSub            0      0     74
       -> MT_UtilKeyEvent               0      0     74
       -> MT_UtilTimeAlive              0      0     74
       -> MT_UtilLedControl             0      0     74
       -> MT_UtilSrcMatchEnable         0      0     74
       -> MT_UtilSrcMatchAddEntry       0      0     74
       -> MT_UtilSrcMatchDeleteEntry
                                        0      0     74
       -> MT_UtilSrcMatchCheckSrcAddr
                                        0      0     74
       -> MT_UtilSrcMatchAckAllPending
                                        0      0     74
       -> MT_UtilSrcMatchCheckAllPending
                                        0      0     74
       -> MT_BuildAndSendZToolResponse
                                        0      0     74
       -> MT_UtilDataReq                0      0     74
       -> MT_UtilAddrMgrEntryLookupExt
                                        0      0     74
       -> AddrMgrEntryLookupNwk         0      0     74
       -> MT_BuildAndSendZToolResponse
                                        0      0     74
       -> osal_memcpy                   0      0     80
       -> ZDSecMgrRequestAppKey         0      0     74
       -> MT_BuildAndSendZToolResponse
                                        0      0     74
       -> AssocCount                    0      0     74
       -> MT_BuildAndSendZToolResponse
                                        0      0     74
       -> MT_UtilAssocFindDevice        0      0     74
       -> MT_UtilAssocGetWithAddress
                                        0      0     74
       -> MT_BuildAndSendZToolResponse
                                        0      0     74
     MT_UtilDataReq                     3      0     38
       -> NwkPollReq                    4      0      2
       -> MT_BuildAndSendZToolResponse
                                        4      0      2
     MT_UtilGetDeviceInfo               1      0     58
       -> AssocMakeList                 0      0     34
       -> osal_mem_alloc                0      0     34
       -> osal_nv_read                  0      0     42
       -> NLME_GetShortAddr             0      0     34
       -> MT_BuildAndSendZToolResponse
                                        0      0     34
       -> osal_mem_free                 0      0     34
       -> osal_mem_free                 0      0     34
     MT_UtilGetNvInfo                   1      0     63
       -> osal_mem_alloc                0      0     44
       -> osal_memset                   0      0     44
       -> osal_nv_read                  0      0     52
       -> osal_nv_read                  0      0     52
       -> osal_nv_read                  0      0     52
       -> osal_nv_read                  0      0     52
       -> osal_nv_read                  0      0     52
       -> MT_BuildAndSendZToolResponse
                                        0      0     44
       -> osal_mem_free                 0      0     44
     MT_UtilKeyEvent                    1      0     47
       -> OnBoard_SendKeys              0      0     20
       -> MT_BuildAndSendZToolResponse
                                        0      0     20
     MT_UtilLedControl                  0      0     47
       -> HalLedSet                     0      0     20
       -> MT_BuildAndSendZToolResponse
                                        0      0     20
     MT_UtilSetChannels                 1      0     66
       -> NLME_UpdateNV                 0      0     50
       -> osal_nv_item_len              0      0     54
       -> osal_nv_write                 0      0     58
       -> MT_BuildAndSendZToolResponse
                                        0      0     50
     MT_UtilSetPanID                    1      0     54
       -> NLME_UpdateNV                 0      0     26
       -> osal_nv_item_len              0      0     30
       -> osal_nv_write                 0      0     34
       -> MT_BuildAndSendZToolResponse
                                        0      0     26
       -> Onboard_soft_reset            0      0     26
     MT_UtilSetPreCfgKey                1      0     52
       -> osal_nv_item_len              0      0     26
       -> osal_nv_write                 0      0     30
       -> MT_BuildAndSendZToolResponse
                                        0      0     22
     MT_UtilSetSecLevel                 1      0     52
       -> osal_nv_item_len              0      0     26
       -> osal_nv_write                 0      0     30
       -> MT_BuildAndSendZToolResponse
                                        0      0     22
     MT_UtilSrcMatchAckAllPending       2      0     38
       -> MT_BuildAndSendZToolResponse
                                        4      0      2
     MT_UtilSrcMatchAddEntry            2      0     38
       -> MT_BuildAndSendZToolResponse
                                        4      0      2
     MT_UtilSrcMatchCheckAllPending     2      0     39
       -> MT_BuildAndSendZToolResponse
                                        4      0      4
     MT_UtilSrcMatchCheckSrcAddr        2      0     39
       -> MT_BuildAndSendZToolResponse
                                        4      0      4
     MT_UtilSrcMatchDeleteEntry         2      0     38
       -> MT_BuildAndSendZToolResponse
                                        4      0      2
     MT_UtilSrcMatchEnable              2      0     38
       -> MT_BuildAndSendZToolResponse
                                        4      0      2
     MT_UtilTimeAlive                   1      0     57
       -> osal_GetSystemClock           0      0     40
       -> MT_BuildAndSendZToolResponse
                                        0      0     40
     packDev_t                          1      0     39


   Segment part sizes:

     Function/Label                         Bytes
     --------------                         -----
     MT_UtilCommandProcessing                523
     MT_UtilGetDeviceInfo                    274
     ?Subroutine0                              8
     ?Subroutine23                             4
     ?Subroutine22                             6
     ??Subroutine37_0                          8
     ?Subroutine6                             11
     ?Subroutine34                             9
     MT_UtilGetNvInfo                        461
     MT_UtilSetPanID                          93
     ?Subroutine24                             9
     ??Subroutine39_0                          8
     ?Subroutine25                            12
     ?Subroutine19                            22
     ?Subroutine7                              7
     ?Subroutine33                            18
     ?Subroutine29                            16
     MT_UtilSetChannels                      223
     ?Subroutine20                             7
     ??Subroutine38_0                          8
     ?Subroutine16                            20
     MT_UtilSetSecLevel                       30
     ?Subroutine1                             15
     ?Subroutine13                            16
     MT_UtilSetPreCfgKey                      32
     MT_UtilCallbackSub                      197
     ?Subroutine2                              6
     ??Subroutine40_0                         15
     ??Subroutine41_0                          8
     MT_UtilKeyEvent                          89
     MT_UtilTimeAlive                        115
     ?Subroutine32                            12
     MT_UtilLedControl                       122
     MT_UtilSrcMatchEnable                     2
     ?Subroutine3                             15
     ??Subroutine42_0                          7
     ??Subroutine43_0                         10
     ?Subroutine30                            17
     MT_UtilSrcMatchAddEntry                   2
     MT_UtilSrcMatchDeleteEntry                2
     MT_UtilSrcMatchCheckSrcAddr              17
     ?Subroutine4                             12
     ?Subroutine15                             7
     ?Subroutine21                             6
     MT_UtilSrcMatchAckAllPending              0
     MT_UtilSrcMatchCheckAllPending           18
     MT_UtilDataReq                           28
     MT_UtilAddrMgrEntryLookupExt            106
     ?Subroutine14                             8
     ?Subroutine31                            16
     MT_UtilAssocFindDevice                   23
     ?Subroutine5                             10
     ?Subroutine26                            30
     MT_UtilAssocGetWithAddress               82
     packDev_t                               165
     ?Subroutine18                             6
     ??Subroutine44_0                         10
     ?Subroutine17                            12
     ?Subroutine12                            13
     ?Subroutine11                             1
     ??Subroutine45_0                          5
     ?Subroutine28                             4
     ?Subroutine35                             9
     ?Subroutine36                             6
     ?Subroutine10                            23
     ?Subroutine9                              4
     ?Subroutine27                            15
     ?Subroutine8                              6
     __Constant_ffffffff                       4
     __Constant_0                              4
     __Constant_3e8                            4
     ??MT_UtilCommandProcessing?relay          6
     ??MT_UtilGetDeviceInfo?relay              6
     ??MT_UtilGetNvInfo?relay                  6
     ??MT_UtilSetPanID?relay                   6
     ??MT_UtilSetChannels?relay                6
     ??MT_UtilSetSecLevel?relay                6
     ??MT_UtilSetPreCfgKey?relay               6
     ??MT_UtilCallbackSub?relay                6
     ??MT_UtilKeyEvent?relay                   6
     ??MT_UtilTimeAlive?relay                  6
     ??MT_UtilLedControl?relay                 6
     ??MT_UtilSrcMatchEnable?relay             6
     ??MT_UtilSrcMatchAddEntry?relay           6
     ??MT_UtilSrcMatchDeleteEntry?relay        6
     ??MT_UtilSrcMatchCheckSrcAddr?relay       6
     ??MT_UtilSrcMatchAckAllPending?relay      6
     ??MT_UtilSrcMatchCheckAllPending?relay    6
     ??MT_UtilDataReq?relay                    6
     ??MT_UtilAddrMgrEntryLookupExt?relay      6
     ??MT_UtilAssocFindDevice?relay            6
     ??MT_UtilAssocGetWithAddress?relay        6
     ??packDev_t?relay                         6

 
 3 101 bytes in segment BANKED_CODE
   132 bytes in segment BANK_RELAYS
    12 bytes in segment XDATA_ROM_C
 
 3 233 bytes of CODE  memory
     0 bytes of CONST memory (+ 12 bytes shared)

Errors: none
Warnings: none
